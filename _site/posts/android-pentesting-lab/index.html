<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="How to set up an Android Penetration Testing Lab from scratch" />
<meta property="og:locale" content="en" />
<meta name="description" content="In this post, we explore different ways to create a fully working environment for Android Penetration Testing and we create our setup using the SDK provided by Google (without installing Visual Studio). Then, we set up the environment to allow communication between Android Virtual Devices and any other VMs. Finally, we explore how to import custom user certificates to intercept HTTPS requests on any version of Android." />
<meta property="og:description" content="In this post, we explore different ways to create a fully working environment for Android Penetration Testing and we create our setup using the SDK provided by Google (without installing Visual Studio). Then, we set up the environment to allow communication between Android Virtual Devices and any other VMs. Finally, we explore how to import custom user certificates to intercept HTTPS requests on any version of Android." />
<link rel="canonical" href="http://localhost:4000/posts/android-pentesting-lab/" />
<meta property="og:url" content="http://localhost:4000/posts/android-pentesting-lab/" />
<meta property="og:site_name" content="0xbro" />
<meta property="og:image" content="http://localhost:4000/assets/img/AndroidLab/thumbnail.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-04-30T00:00:00+02:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/img/AndroidLab/thumbnail.png" />
<meta property="twitter:title" content="How to set up an Android Penetration Testing Lab from scratch" />
<meta name="twitter:site" content="@sec_0xbro" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-04-30T00:00:00+02:00","datePublished":"2023-04-30T00:00:00+02:00","description":"In this post, we explore different ways to create a fully working environment for Android Penetration Testing and we create our setup using the SDK provided by Google (without installing Visual Studio). Then, we set up the environment to allow communication between Android Virtual Devices and any other VMs. Finally, we explore how to import custom user certificates to intercept HTTPS requests on any version of Android.","headline":"How to set up an Android Penetration Testing Lab from scratch","image":"http://localhost:4000/assets/img/AndroidLab/thumbnail.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/android-pentesting-lab/"},"url":"http://localhost:4000/posts/android-pentesting-lab/"}</script>
<!-- End Jekyll SEO tag -->


  <title>How to set up an Android Penetration Testing Lab from scratch | 0xbro
  </title>

  <!--
  Custom Favicons - using favicon.ico only
-->

<link rel="icon" type="image/x-icon" href="/assets/img/favicons/favicon.png">
<link rel="shortcut icon" href="/assets/img/favicons/favicon.png">

  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.36.4/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.18/dayjs.min.js,npm/dayjs@1.11.18/locale/en.js,npm/dayjs@1.11.18/plugin/relativeTime.js,npm/dayjs@1.11.18/plugin/localizedFormat.js,npm/tocbot@4.36.4/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/0xbro-light.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">0xbro</a>
    <p class="site-subtitle fst-italic mb-0">A penetration tester, vulnerability researcher, content creator & wannabe ethical hacker blog.</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>

      <!-- Main tabs: Talks, Side projects, About (order 1-4) -->
      
        
          <li class="nav-item">
            <a href="/about/" class="nav-link">
              <i class="fa-fw fas fa-info-circle"></i>
              <span>ABOUT</span>
            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a href="/timeline/" class="nav-link">
              <i class="fa-fw fas fa-timeline"></i>
              <span>TIMELINE</span>
            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a href="/disclosure/" class="nav-link">
              <i class="fa-fw fas fa-handshake"></i>
              <span>DISCLOSURE</span>
            </a>
          </li>
        
      
        
      
        
      
        
      
        
      

      <!-- Separator -->
      <li class="nav-item nav-separator">
        <hr class="sidebar-divider">
      </li>

      <!-- Blog tabs: Archive, Categories, Tags (order 5+) -->
      
        
      
        
      
        
      
        
          <li class="nav-item">
            <a href="/categories/" class="nav-link">
              <i class="fa-fw fas fa-stream"></i>
              <span>CATEGORIES</span>
            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a href="/projects/" class="nav-link">
              <i class="fa-fw fas fa-code"></i>
              <span>PROJECTS</span>
            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a href="/tags/" class="nav-link">
              <i class="fa-fw fas fa-tags"></i>
              <span>TAGS</span>
            </a>
          </li>
        
      
        
          <li class="nav-item">
            <a href="/archives/" class="nav-link">
              <i class="fa-fw fas fa-archive"></i>
              <span>ARCHIVES</span>
            </a>
          </li>
        
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    

      
        <a
          href="https://github.com/0xb120"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    

      
        <a
          href="https://twitter.com/sec_0xbro"
          aria-label="twitter"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fa-brands fa-x-twitter"></i>
        </a>
      
    
          
      

      
        <a
          href="https://www.linkedin.com/in/mattia-brollo-b4129614b/"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    
          
        

      
        <a
          href="/feed.xml"
          aria-label="rss"
          

          

          

          
        >
          <i class="fas fa-rss"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->

    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>How to set up an Android Penetration Testing Lab from scratch</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link" aria-label="Search">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  

  
  

  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>How to set up an Android Penetration Testing Lab from scratch</h1>
    
      <p class="post-desc fw-light mb-4">In this post, we explore different ways to create a fully working environment for Android Penetration Testing and we create our setup using the SDK provided by Google (without installing Visual Studio). Then, we set up the environment to allow communication between Android Virtual Devices and any other VMs. Finally, we explore how to import custom user certificates to intercept HTTPS requests on any version of Android.</p>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1682805600"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Apr 30, 2023
</time>

      </span>

      <!-- lastmod date -->
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/assets/img/AndroidLab/thumbnail.png" class="popup img-link preview-img shimmer"><img src="/assets/img/AndroidLab/thumbnail.png"  alt="Preview Image" width="1200" height="630"  loading="lazy"></a></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://twitter.com/sec_0xbro">0xbro</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="2733 words"
>
  <em>15 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">How to set up an Android Penetration Testing Lab from scratch</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">How to set up an Android Penetration Testing Lab from scratch</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <h1 id="introduction">Introduction</h1>
<p>In this post, we explore different ways to create a fully working <strong>environment for Android Penetration Testing</strong> and we create our setup using the <strong>SDK</strong> provided by Google (without installing Visual Studio), an Ubuntu machine running on WSL, and also an external virtual machine. Then, we set up the environment to <strong>allow communication between Android Virtual Devices and any other VMs</strong>. Finally, we explore how to <strong>import custom user certificates</strong> to intercept HTTPS requests on any version of Android.</p>

<h2 id="video"><span class="me-2">Video</span><a href="#video" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<iframe width="560" height="315" src="https://www.youtube.com/embed/v-p1dTWmWDY" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

<hr />

<h1 id="writeup-tldr">Writeup [TL;DR]</h1>
<h2 id="introduction-and-summary"><span class="me-2">Introduction and summary</span><a href="#introduction-and-summary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Hey! Today’s article is very basic. I’ll show you how I set up my Android pentesting environment without using either Genymotion or Android Studio, and then I will give you some little tips on how I managed to solve some little issues that prevented me from using external VMs with this setup. Finally, I will show you a simple trick to install Burpsuite certificates inside the system certificate store on newer Android devices.</p>

<p>Let’s begin!</p>

<h2 id="from-genymotion-to-androids-cmdline-tools"><span class="me-2">From Genymotion to Android’s cmdline tools</span><a href="#from-genymotion-to-androids-cmdline-tools" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<p>Android application penetration testing requires multiple devices with different OS versions to analyze the behavior of the APK in any possible situation. We need a stable and responsive environment that gives us as much flexibility as possible.</p>

<p>Initially, my first Android emulator was Genymotion. It is easy to set up, supports bridging its network-card adapter instead of using NAT, and uses Virtualbox to emulate the various devices, which at the time was the emulation software I also used to run my Linux machines.</p>

<p>With time, however, I moved to VMWare, and I was forced to look for some Genymotion alternatives because of two main reasons.
First, there were some coexistence problems between VMWare and Genymotion, 
and second, Genymotion started requiring a paid license to run the latest Android version required to test applications on modern systems.</p>

<p>To overcome these limitations, so, I decided to try the official Android emulator. The one thing that I really hated at the beginning was having to necessarily install Android Studio to use emulators.</p>

<p>Then I realized that Android also provides the <code class="language-plaintext highlighter-rouge">android_sdk</code> independently from Android Studio, allowing us to save many gigabytes of space.</p>

<p>This is my current setup, and now I will guide you in creating the same environment for yourself.</p>

<h3 id="digression-on-corellium"><span class="me-2">Digression on Corellium</span><a href="#digression-on-corellium" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>A little disclaimer before starting: recently, a new service named Corellium<sup id="fnref:corellium"><a href="#fn:corellium" class="footnote" rel="footnote" role="doc-noteref">1</a></sup> broke into the scene as one of the best emulators and testing platforms out there. It allows emulating any Android or iOS device directly in the cloud and also supports ARM devices. The service is not free and is most suited for Enterprises, but it can also be paid based on consumption. If you are unsure, you can also require a free evaluation trial. As I said, it’s one of the most appreciated emulators, so it’s nice to know.</p>

<p>And in case you were wondering, no, I’m not at all affiliated with Corelium, otherwise I wouldn’t have created the environment that we’re going to reproduce.</p>

<h2 id="requirements-download-and-introduction-to-the-androids-utilities"><span class="me-2">Requirements download and introduction to the Android’s utilities</span><a href="#requirements-download-and-introduction-to-the-androids-utilities" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>Let’s go back to our configuration: the first requirement we must install before setting up the environment is the Java Development Kit<sup id="fnref:JDK"><a href="#fn:JDK" class="footnote" rel="footnote" role="doc-noteref">2</a></sup>, which we can download from the official Java website.</p>

<p>Once installed, we can download the Android command-line tools<sup id="fnref:cmdline"><a href="#fn:cmdline" class="footnote" rel="footnote" role="doc-noteref">3</a></sup> and Android platform tools<sup id="fnref:plattools"><a href="#fn:plattools" class="footnote" rel="footnote" role="doc-noteref">4</a></sup> from the official website. I downloaded the Windows version because my host operating system is Windows 11. On Linux and macOS, however, the process should be the same.</p>

<p>The <code class="language-plaintext highlighter-rouge">cmdline-tools</code><sup id="fnref:cmdlinetools"><a href="#fn:cmdlinetools" class="footnote" rel="footnote" role="doc-noteref">5</a></sup> are the utilities required to download and install new SDK, create and run virtual devices, analyze APKs, and manage the environment.</p>

<div class="language-ps highlighter-rouge"><div class="code-header">
        <span data-label-text="Ps"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="nf">PS</span> <span class="nf">C:\Users\bro\Desktop\android_tools\android_sdk\cmdline-tools\latest\bin</span><span class="p">&gt;</span> <span class="nf">ls</span>

<span class="nf">Mode</span>                 <span class="nf">LastWriteTime</span>         <span class="nf">Length</span> <span class="nf">Name</span>
<span class="nf">----</span>                 <span class="nf">-------------</span>         <span class="nf">------</span> <span class="nf">----</span>
<span class="nf">-a----</span>        <span class="mf">24</span><span class="nv">/03/2023</span>     <span class="nf">20:18</span>           <span class="mf">2297</span> <span class="nf">apkanalyzer.bat</span>
<span class="nf">-a----</span>        <span class="mf">24</span><span class="nv">/03/2023</span>     <span class="nf">20:18</span>           <span class="mf">2288</span> <span class="nf">avdmanager.bat</span>
<span class="nf">-a----</span>        <span class="mf">24</span><span class="nv">/03/2023</span>     <span class="nf">20:18</span>           <span class="mf">2242</span> <span class="nf">lint.bat</span>
<span class="nf">-a----</span>        <span class="mf">24</span><span class="nv">/03/2023</span>     <span class="nf">20:18</span>           <span class="mf">2222</span> <span class="nf">profgen.bat</span>
<span class="nf">-a----</span>        <span class="mf">24</span><span class="nv">/03/2023</span>     <span class="nf">20:18</span>           <span class="mf">2222</span> <span class="nf">retrace.bat</span>
<span class="nf">-a----</span>        <span class="mf">24</span><span class="nv">/03/2023</span>     <span class="nf">20:18</span>           <span class="mf">2285</span> <span class="nf">screenshot2.bat</span>
<span class="nf">-a----</span>        <span class="mf">24</span><span class="nv">/03/2023</span>     <span class="nf">20:18</span>           <span class="mf">2295</span> <span class="nf">sdkmanager.bat</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Platform tools on the other side, are utilities that interface with the Android platform. The most useful and important ones for our needs are <code class="language-plaintext highlighter-rouge">adb</code>, <code class="language-plaintext highlighter-rouge">sqlite</code> and <code class="language-plaintext highlighter-rouge">fastboot</code>.</p>

<div class="language-ps highlighter-rouge"><div class="code-header">
        <span data-label-text="Ps"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre><span class="nf">PS</span> <span class="nf">C:\Users\bro\Desktop\android_tools\android_sdk\platform-tools</span><span class="p">&gt;</span> <span class="nf">ls</span>

<span class="nf">Mode</span>                 <span class="nf">LastWriteTime</span>         <span class="nf">Length</span> <span class="nf">Name</span>
<span class="nf">----</span>                 <span class="nf">-------------</span>         <span class="nf">------</span> <span class="nf">----</span>
<span class="nf">-a----</span>        <span class="mf">30</span><span class="nv">/03/2023</span>     <span class="nf">10:28</span>        <span class="mf">6021632</span> <span class="nf">adb.exe</span>
<span class="nf">-a----</span>        <span class="mf">30</span><span class="nv">/03/2023</span>     <span class="nf">10:28</span>          <span class="mf">97792</span> <span class="nf">AdbWinApi.dll</span>
<span class="nf">-a----</span>        <span class="mf">30</span><span class="nv">/03/2023</span>     <span class="nf">10:28</span>          <span class="mf">62976</span> <span class="nf">AdbWinUsbApi.dll</span>
<span class="nf">-a----</span>        <span class="mf">30</span><span class="nv">/03/2023</span>     <span class="nf">10:29</span>         <span class="mf">241664</span> <span class="nf">dmtracedump.exe</span>
<span class="nf">-a----</span>        <span class="mf">30</span><span class="nv">/03/2023</span>     <span class="nf">10:29</span>         <span class="mf">432640</span> <span class="nf">etc1tool.exe</span>
<span class="nf">-a----</span>        <span class="mf">30</span><span class="nv">/03/2023</span>     <span class="nf">10:29</span>        <span class="mf">1866240</span> <span class="nf">fastboot.exe</span>
<span class="nf">-a----</span>        <span class="mf">30</span><span class="nv">/03/2023</span>     <span class="nf">10:29</span>          <span class="mf">44032</span> <span class="nf">hprof-conv.exe</span>
<span class="nf">-a----</span>        <span class="mf">30</span><span class="nv">/03/2023</span>     <span class="nf">10:29</span>         <span class="mf">231594</span> <span class="nf">libwinpthread-1.dll</span>
<span class="nf">-a----</span>        <span class="mf">30</span><span class="nv">/03/2023</span>     <span class="nf">10:29</span>         <span class="mf">469504</span> <span class="nf">make_f2fs.exe</span>
<span class="nf">-a----</span>        <span class="mf">30</span><span class="nv">/03/2023</span>     <span class="nf">10:29</span>         <span class="mf">469504</span> <span class="nf">make_f2fs_casefold.exe</span>
<span class="nf">-a----</span>        <span class="mf">30</span><span class="nv">/03/2023</span>     <span class="nf">10:29</span>           <span class="mf">1157</span> <span class="nf">mke2fs.conf</span>
<span class="nf">-a----</span>        <span class="mf">30</span><span class="nv">/03/2023</span>     <span class="nf">10:29</span>         <span class="mf">747520</span> <span class="nf">mke2fs.exe</span>
<span class="nf">-a----</span>        <span class="mf">30</span><span class="nv">/03/2023</span>     <span class="nf">10:28</span>        <span class="mf">1073883</span> <span class="nf">NOTICE.txt</span>
<span class="nf">-a----</span>        <span class="mf">30</span><span class="nv">/03/2023</span>     <span class="nf">10:40</span>           <span class="mf">1367</span> <span class="nf">package.xml</span>
<span class="nf">-a----</span>        <span class="mf">30</span><span class="nv">/03/2023</span>     <span class="nf">10:29</span>             <span class="mf">38</span> <span class="nf">source.properties</span>
<span class="nf">-a----</span>        <span class="mf">30</span><span class="nv">/03/2023</span>     <span class="nf">10:29</span>        <span class="mf">1333760</span> <span class="nf">sqlite3.exe</span>
</pre></td></tr></tbody></table></code></div></div>

<h2 id="android-sdk-download-and-avd-configuration"><span class="me-2">Android SDK download and AVD configuration</span><a href="#android-sdk-download-and-avd-configuration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>Alright! Now we must download and install the SDK we will use to create our virtual devices.
First, follow the instructions specified in the official documentation<sup id="fnref:sdkmanager"><a href="#fn:sdkmanager" class="footnote" rel="footnote" role="doc-noteref">6</a></sup> to create a valid <code class="language-plaintext highlighter-rouge">android_sdk</code> environment. I created a specific folder named <code class="language-plaintext highlighter-rouge">android_sdk</code> and moved the various tools inside it, as mentioned in the <code class="language-plaintext highlighter-rouge">sdkmanager</code> manual.</p>

<p>Now we can use the <code class="language-plaintext highlighter-rouge">sdkmanager</code> utility to list and install any desired SDK. Using the <code class="language-plaintext highlighter-rouge">--list</code> command we can list all the available kit. The ones we are interested in are the “system-images”, however, feel free to experiment also with all the other SDKs.</p>

<p>Once we have chosen a specific SDK, we can install it. Completed the installation process, we can verify that the SDK has been correctly installed using the <code class="language-plaintext highlighter-rouge">--list_installed</code> command.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="c"># list all the available sdk</span>
 .<span class="se">\s</span>dkmanager.bat <span class="nt">--list</span>
...
system-images<span class="p">;</span>android-29<span class="p">;</span>google_apis_playstore<span class="p">;</span>x86                                       | 8            | Google Play Intel x86 Atom System Image
system-images<span class="p">;</span>android-29<span class="p">;</span>google_apis_playstore<span class="p">;</span>x86_64                                    | 8            | Google Play Intel x86_64 Atom System Image
system-images<span class="p">;</span>android-30<span class="p">;</span>android-tv<span class="p">;</span>x86                                                  | 4            | Android TV Intel x86 Atom System Image
system-images<span class="p">;</span>android-30<span class="p">;</span>android-wear-cn<span class="p">;</span>arm64-v8a                                       | 10           | China version of Wear OS 3 - Preview ARM 64 v8a System Image
...

<span class="c"># install a specific sdk</span>
.<span class="se">\s</span>dkmanager.bat <span class="nt">--install</span> <span class="s2">"system-images;android-29;google_apis;x86"</span>

<span class="c"># list installed sdk </span>
.<span class="se">\s</span>dkmanager.bat <span class="nt">--list_installed</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Good, at this point we can create a virtual device using the just downloaded SDK.</p>

<p>We can create AVDs using the <code class="language-plaintext highlighter-rouge">avdmanager</code> utility<sup id="fnref:avdmanager"><a href="#fn:avdmanager" class="footnote" rel="footnote" role="doc-noteref">7</a></sup>. We can list all the available devices using the <code class="language-plaintext highlighter-rouge">list devices</code> command, and we can create a virtual device using <code class="language-plaintext highlighter-rouge">create avd</code> with the <code class="language-plaintext highlighter-rouge">-n</code> flag to specify a custom name, <code class="language-plaintext highlighter-rouge">-k</code> to specify the desired Android API to install, and, eventually, <code class="language-plaintext highlighter-rouge">-d</code> to select a specific hardware profile.</p>

<p>In this way can create as many virtual devices we want, and we can list all of them using the <code class="language-plaintext highlighter-rouge">list avd</code> command.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre><span class="c"># list all possible emulators</span>
.<span class="se">\a</span>vdmanager.bat list devices

<span class="c"># create an emulator (C:\Users\name\.android\avd\)</span>
.<span class="se">\a</span>vdmanager.bat <span class="nt">--verbose</span> create avd <span class="nt">--force</span> <span class="nt">--name</span> <span class="s2">"generic_api29_google_apis_emulator"</span> <span class="nt">--package</span> <span class="s2">"system-images;android-29;google_apis;x86"</span> <span class="nt">--tag</span> <span class="s2">"google_apis"</span> <span class="nt">--abi</span> <span class="s2">"x86"</span>
.<span class="se">\a</span>vdmanager.bat create avd <span class="nt">-n</span> <span class="s2">"generic_api29_google_apis_emulator"</span> <span class="nt">-k</span> <span class="s2">"system-images;android-29;google_apis;x86"</span>

<span class="c"># list installed avd</span>
.<span class="se">\a</span>vdmanager.bat list avd
Available Android Virtual Devices:
    Name: generic_api29_google_apis_emulator
    Path: C:<span class="se">\U</span>sers<span class="se">\b</span>ro<span class="se">\.</span>android<span class="se">\a</span>vd<span class="se">\g</span>eneric_api29_google_apis_emulator.avd
  Target: Google APIs <span class="o">(</span>Google Inc.<span class="o">)</span>
          Based on: Android 10.0 <span class="o">(</span>Q<span class="o">)</span> Tag/ABI: google_apis/x86
  Sdcard: 512 MB

<span class="c"># delete emulator</span>
 .<span class="se">\a</span>vdmanager.bat delete avd <span class="nt">-n</span> generic_api29_google_apis_emulator

<span class="c"># rename emulator</span>
.<span class="se">\a</span>vdmanager.bat move avd <span class="nt">-n</span> generic_28 <span class="nt">-r</span> android-9_api-28
</pre></td></tr></tbody></table></code></div></div>

<p>Ok, now we can try those emulators. We can use the emulator tool with the <code class="language-plaintext highlighter-rouge">-list-avds</code> option to list all the available devices, and we can run them using the <code class="language-plaintext highlighter-rouge">-avd</code> flag followed by the device’s name. We can also use the <code class="language-plaintext highlighter-rouge">-scale</code> parameter to increase or decrease the screen size, and <code class="language-plaintext highlighter-rouge">-writable-system</code> to run the emulator with write privileges for system partitions.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="c"># list available emulators</span>
PS C:<span class="se">\U</span>sers<span class="se">\b</span>ro<span class="se">\D</span>esktop<span class="se">\a</span>ndroid_tools<span class="se">\a</span>ndroid_sdk<span class="se">\e</span>mulator&gt; .<span class="se">\e</span>mulator.exe <span class="nt">-list-avds</span>
generic_api29_google_apis_emulator

<span class="c"># start a device</span>
.<span class="se">\e</span>mulator.exe <span class="nt">-avd</span> generic_28

<span class="c"># start a device in writable mode with a bigger GUI</span>
.<span class="se">\e</span>mulator.exe <span class="nt">-avd</span> generic_28 <span class="nt">-writable-system</span> <span class="nt">-scale</span> 0.6
</pre></td></tr></tbody></table></code></div></div>

<p>If your emulator crashes when using the <code class="language-plaintext highlighter-rouge">-writable-system</code> flag, enable the Hyper-V support inside the Windows feature menù and eventually enable also the cold boot<sup id="fnref:coldboot"><a href="#fn:coldboot" class="footnote" rel="footnote" role="doc-noteref">8</a></sup> for your emulator.</p>

<p>The first time we run the emulator, we probably obtain some errors telling us that the tool doesn’t find the correct paths for the SDK folder.</p>

<p><a href="/assets/img/AndroidLab/androidlab-2.png" class="popup img-link shimmer"><img src="/assets/img/AndroidLab/androidlab-2.png" alt="androidlab-2.png" loading="lazy"></a></p>

<p>This is because you are not subscribed to my channel and have not yet left a like. Of course, I’m joking, but it would be appreciated so much, so thanks in advance!</p>

<p>The reason why we get those errors is that we didn’t set the <code class="language-plaintext highlighter-rouge">ANDROID_HOME</code> environment variable when we downloaded the command-line tools. To fix this issue, we must create the <code class="language-plaintext highlighter-rouge">ANDROID_HOME</code> variable containing the <code class="language-plaintext highlighter-rouge">android_sdk</code> folder as the value.</p>

<p><a href="/assets/img/AndroidLab/androidlab-3.png" class="popup img-link shimmer"><img src="/assets/img/AndroidLab/androidlab-3.png" alt="androidlab-3.png" loading="lazy"></a></p>

<p>Besides that, we also need to manually create a <code class="language-plaintext highlighter-rouge">platforms</code> folder inside <code class="language-plaintext highlighter-rouge">android_sdk</code>, otherwise, <code class="language-plaintext highlighter-rouge">emulator.exe</code> will not work again.</p>

<blockquote>
  <p>The folder structure must be as the one below:</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="o">&gt;</span> Directory: C:<span class="se">\U</span>sers<span class="se">\b</span>ro<span class="se">\D</span>esktop<span class="se">\a</span>ndroid_tools<span class="se">\a</span>ndroid_sdk


Mode                 LastWriteTime         Length Name
<span class="nt">----</span>                 <span class="nt">-------------</span>         <span class="nt">------</span> <span class="nt">----</span>
d-----        30/03/2023     11:22                .temp
d-----        30/03/2023     00:13                cmdline-tools
d-----        30/03/2023     00:55                emulator
d-----        30/03/2023     11:18                licenses
d-----        30/03/2023     00:54                patcher
d-----        30/03/2023     10:40                platform-tools
d-----        30/03/2023     10:29                platforms
d-----        30/03/2023     11:18                system-images
<span class="nt">-a----</span>        30/03/2023     11:24             16 .knownPackages
</pre></td></tr></tbody></table></code></div></div>

<p>After rebooting the host machine, we should be able to start our Android Virtual Device.</p>

<p>Unfortunately, the emulator is not yet ready: the hardware buttons are broken. To enable them<sup id="fnref:avd-hw"><a href="#fn:avd-hw" class="footnote" rel="footnote" role="doc-noteref">9</a></sup>, we must go to the <code class="language-plaintext highlighter-rouge">.android</code> folder, edit the <code class="language-plaintext highlighter-rouge">config.ini</code> file for every emulator we want to fix, and set the <code class="language-plaintext highlighter-rouge">hw.keyboard</code> and <code class="language-plaintext highlighter-rouge">hw.mainKeys</code> fields to yes.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>edit ~/.android/avd/&lt;emulator name&gt;/config.ini
...
hw.keyboard<span class="o">=</span><span class="nb">yes</span>
...
hw.mainKeys<span class="o">=</span><span class="nb">yes</span>
...
</pre></td></tr></tbody></table></code></div></div>

<p>If we run the emulator now, the buttons are working as expected and we can finally use it as a traditional physical device.</p>

<h3 id="current-environment-limitations"><span class="me-2">Current environment limitations</span><a href="#current-environment-limitations" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Up to this point, the main environment is ready.</p>

<p>We can use the <code class="language-plaintext highlighter-rouge">adb</code> binary contained in <code class="language-plaintext highlighter-rouge">platform-tools</code> to interact with our virtual devices, and we can even install some other tools, like <code class="language-plaintext highlighter-rouge">frida</code>, to expand our toolset. The only limitation is that we are forced to use our host system.</p>

<p>Linux users should not have problems using their host as a testing machine, so, the next part of the post is most suited for Windows users that maybe want to use external virtual machines for testing their apps.</p>

<p>By default, every emulator listens for incoming connections on ports 5554, 5555, or higher, but they are only bound to localhost and cannot be reached by other NATed devices.
We can do some port-forwarding magic and make those ports available on all the other interfaces, but <code class="language-plaintext highlighter-rouge">adb</code> also requires a USB connection to work properly, so for this single tool, it is better to use the binary provided by the <code class="language-plaintext highlighter-rouge">platform-tools</code>.</p>

<p>Nevertheless, we can use <code class="language-plaintext highlighter-rouge">frida</code> as a better example to show how to set up all the forwarding rules for all the other necessities.</p>

<p>Frida can be divided into two main components: the <code class="language-plaintext highlighter-rouge">frida-server</code> and the <code class="language-plaintext highlighter-rouge">frida-tools</code>. In our example, we have a <code class="language-plaintext highlighter-rouge">frida-server</code> running on any emulator’s interface, but we wanna use the <code class="language-plaintext highlighter-rouge">frida-tools</code> installed inside an Ubuntu WSL machine instead of the ones installed on the Windows host system.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>./frida-server <span class="nt">-l</span> 0.0.0.0:10099
</pre></td></tr></tbody></table></code></div></div>

<h3 id="configure-different-port-forwarding-rules-to-overcome-environment-limitations"><span class="me-2">Configure different port-forwarding rules to overcome environment limitations</span><a href="#configure-different-port-forwarding-rules-to-overcome-environment-limitations" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>
<p>Ubuntu and Andriod cannot communicate with each other because they both use a NATed IP.</p>

<p><a href="/assets/img/AndroidLab/androidlab-1.png" class="popup img-link shimmer"><img src="/assets/img/AndroidLab/androidlab-1.png" alt="androidlab-1.png" loading="lazy"></a></p>

<p>Ubuntu has an IP of 172.22.172.244 and uses 172.22.160.1  - which is our Windows host machine - as a gateway.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>ip a
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
    <span class="nb">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host
       valid_lft forever preferred_lft forever
...
6: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000
    <span class="nb">link</span>/ether 00:15:5d:3b:4e:71 brd ff:ff:ff:ff:ff:ff
    inet 172.22.172.244/20
...
<span class="nv">$ </span>traceroute google.com
traceroute to google.com <span class="o">(</span>142.251.209.46<span class="o">)</span>, 30 hops max, 60 byte packets
 1  0xbro.mshome.net <span class="o">(</span>172.22.160.1<span class="o">)</span>  0.429 ms  0.391 ms  0.364 ms
</pre></td></tr></tbody></table></code></div></div>

<p>Android has an IP of 10.0.2.15 and uses a standardized infrastructure<sup id="fnref:avd-net"><a href="#fn:avd-net" class="footnote" rel="footnote" role="doc-noteref">10</a></sup>, having a virtual router with IP 10.0.2.1 as a getaway.</p>

<p>Luckily, we can access this virtual router using telnet. The credentials required to access the routers can be found inside the <code class="language-plaintext highlighter-rouge">.emulator_console_auth_token</code> file. Once inside, we can set the desired port forwarding rules using the <code class="language-plaintext highlighter-rouge">redir add</code> command, followed by the protocol, the port to be opened on the host, and the emulator’s port bound to the rule.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre><span class="c"># Auth credential</span>
more C:<span class="se">\U</span>sers<span class="se">\b</span>ro<span class="se">\.</span>emulator_console_auth_token
this_is_a_fake_password

<span class="c"># Login inside the virtual router and set port forwarding</span>
telnet 127.0.0.1 5554
Android Console: you can find your &lt;auth_token&gt; <span class="k">in</span>
<span class="s1">'C:\Users\bro\.emulator_console_auth_token'</span>
OK
auth this_is_a_fake_password
<span class="c"># For example, the following command sets up a redirection that handles all incoming TCP connections to your host (development) machine on 127.0.0.1:5000 and passes them through to the emulated system on 10.0.2.15:6000</span>
redir add tcp:5000:6000
redir add tcp:10099:27042
PS C:<span class="se">\W</span>INDOWS<span class="se">\s</span>ystem32&gt; netstat <span class="nt">-ano</span> | findstr 10099
  TCP    127.0.0.1:10099        0.0.0.0:0              LISTENING       24980

<span class="c"># List active rules</span>
redir list

<span class="c"># Delete a specific rule</span>
redir del
</pre></td></tr></tbody></table></code></div></div>

<p>Then, we must create another port forwarding rule, this time directly on Windows. This rule is responsible for connecting the port we just opened with <code class="language-plaintext highlighter-rouge">redir add</code> - and which is only available in localhost - with another port, this time available on all network interfaces.</p>

<p><a href="/assets/img/AndroidLab/androidlab-4.png" class="popup img-link shimmer"><img src="/assets/img/AndroidLab/androidlab-4.png" alt="androidlab-4.png" loading="lazy"></a></p>

<p>For this rule, we can use the <code class="language-plaintext highlighter-rouge">netsh interface portproxy</code> command or, in the alternative, <code class="language-plaintext highlighter-rouge">ssh</code>.</p>

<div class="language-ps highlighter-rouge"><div class="code-header">
        <span data-label-text="Ps"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="nf">PS</span><span class="p">&gt;</span> <span class="nf">netsh</span> <span class="nf">interface</span> <span class="nf">portproxy</span> <span class="nb">add</span> <span class="nf">v4tov4</span> <span class="nf">listenport=10100</span> <span class="nf">listenaddress=0.0.0.0</span> <span class="nf">connectport=10099</span> <span class="nf">connectaddress=127.0.0.1</span>

<span class="nf">PS</span><span class="p">&gt;</span> <span class="nf">netsh</span> <span class="nf">interface</span> <span class="nf">portproxy</span> <span class="nb">show</span> <span class="nf">all</span>

<span class="nf">Listen</span> <span class="nf">on</span> <span class="nf">ipv4:</span>             <span class="nf">Connect</span> <span class="nf">to</span> <span class="nf">ipv4:</span>

<span class="nf">Address</span>         <span class="nf">Port</span>        <span class="nf">Address</span>         <span class="nf">Port</span>
<span class="nf">---------------</span> <span class="nf">----------</span>  <span class="nf">---------------</span> <span class="nf">----------</span>
<span class="nf">0.0.0.0</span>         <span class="mf">10100</span>       <span class="nf">127.0.0.1</span>       <span class="mf">10099</span>
</pre></td></tr></tbody></table></code></div></div>

<p>Finally, I recommend disabling any firewall rule enabled on the Windows host so that our internal requests cannot be blocked.</p>

<p>Perfect, at this point the environment is completely set up. We can query the <code class="language-plaintext highlighter-rouge">frida-server</code> running on the Android device by targeting the WSL gateway IP on the port opened on the Windows host. If we have configured everything correctly we should receive the output from <code class="language-plaintext highlighter-rouge">frida</code> and thus communicate with our device.</p>

<p>We can do the same thing if we need to connect the Android emulator to a virtual machine.</p>

<p>I know is a tricky setup, but someday it may be useful.</p>

<h2 id="import-custom-certificates-inside-android-10"><span class="me-2">Import custom certificates inside Android &gt;=10</span><a href="#import-custom-certificates-inside-android-10" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>
<p>At this point, the last thing we need to do is import the burpsuite certificate within the system certificate store. I already talked about certificate stores during the “Android Application Pinning Bypass” video<sup id="fnref:video"><a href="#fn:video" class="footnote" rel="footnote" role="doc-noteref">11</a></sup>, so check it out for more details.</p>

<p>By default, the system certificate store is a read-only file system and it’s pre-populated during the device boot. Luckily, an article<sup id="fnref:mitmproxy"><a href="#fn:mitmproxy" class="footnote" rel="footnote" role="doc-noteref">12</a></sup> by mitmproxy shows a fantastic step-by-step procedure that really fits the bill and that we can follow. It shows how to generate a valid certificate for Android, but most importantly shows how to disable the secure boot verification in order to remount the read-only partitions this time with write privileges.</p>

<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td><td class="rouge-code"><pre><span class="c"># convert burpsuite certificate from der to cer/pem/crt</span>
openssl x509 <span class="nt">-inform</span> der <span class="nt">-in</span> burp-free.der <span class="nt">-out</span> burp-free.cer

<span class="c"># extract the hash to be used for the certificate name</span>
openssl x509 <span class="nt">-inform</span> PEM <span class="nt">-subject_hash_old</span> <span class="nt">-in</span> burp-free.cer | <span class="nb">head</span> <span class="nt">-1</span>
9a5ba575
<span class="nb">cp </span>burp-free.cer 9a5ba575.0

<span class="c"># install the certificate inside the system certificate store</span>
.<span class="se">\e</span>mulator.exe <span class="nt">-avd</span> &lt;avd_name_here&gt; <span class="nt">-writable-system</span>
.<span class="se">\a</span>db.exe root
.<span class="se">\a</span>db.exe disable-verity
.<span class="se">\a</span>db.exe reboot
.<span class="se">\a</span>db.exe root
.<span class="se">\a</span>db.exe remount
.<span class="se">\a</span>db.exe push 9a5ba575.0 /system/etc/security/cacerts
.<span class="se">\a</span>db.exe shell <span class="nb">chmod </span>644 /system/etc/security/cacerts/9a5ba575.0
.<span class="se">\a</span>db.exe reboot

<span class="c"># or</span>

.<span class="se">\e</span>mulator.exe <span class="nt">-avd</span> &lt;avd_name_here&gt; <span class="nt">-writable-system</span>
.<span class="se">\a</span>db.exe root
.<span class="se">\a</span>db.exe shell avbctl disable-verification
.<span class="se">\a</span>db.exe reboot
.<span class="se">\a</span>db.exe root
.<span class="se">\a</span>db.exe remount
.<span class="se">\a</span>db.exe push 9a5ba575.0 /system/etc/security/cacerts
.<span class="se">\a</span>db.exe shell <span class="nb">chmod </span>644 /system/etc/security/cacerts/9a5ba575.0
.<span class="se">\a</span>db.exe reboot
</pre></td></tr></tbody></table></code></div></div>

<p>Once finished, we can set our proxy using the AVD extended controls and now we should be able to intercept and read all the HTTP traffic generated by our virtual device.</p>

<p>Online I read a lot of threads talking about different methods and procedures, but actually, this was the only one that in my case worked consistently.</p>

<p>Having said that, see you next time! Ciao!</p>

<hr />

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:corellium">
      <p><a href="https://www.corellium.com/">https://www.corellium.com/</a> <a href="#fnref:corellium" class="reversefootnote" role="doc-backlink">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:JDK">
      <p><a href="https://www.oracle.com/java/technologies/downloads/">https://www.oracle.com/java/technologies/downloads/</a> <a href="#fnref:JDK" class="reversefootnote" role="doc-backlink">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:cmdline">
      <p><a href="https://developer.android.com/studio#:~:text=Command%20line%20tools%20only">https://developer.android.com/studio#:~:text=Command%20line%20tools%20only</a> <a href="#fnref:cmdline" class="reversefootnote" role="doc-backlink">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:plattools">
      <p><a href="https://developer.android.com/studio/releases/platform-tools">https://developer.android.com/studio/releases/platform-tools</a> <a href="#fnref:plattools" class="reversefootnote" role="doc-backlink">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:cmdlinetools">
      <p><a href="https://developer.android.com/tools">https://developer.android.com/tools</a> <a href="#fnref:cmdlinetools" class="reversefootnote" role="doc-backlink">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:sdkmanager">
      <p><a href="https://developer.android.com/tools/sdkmanager">https://developer.android.com/tools/sdkmanager</a> <a href="#fnref:sdkmanager" class="reversefootnote" role="doc-backlink">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:avdmanager">
      <p><a href="https://developer.android.com/tools/avdmanager">https://developer.android.com/tools/avdmanager</a> <a href="#fnref:avdmanager" class="reversefootnote" role="doc-backlink">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:coldboot">
      <p><a href="https://stackoverflow.com/questions/50420374/how-to-cold-boot-emulators-running-api-27-on-android-studio">https://stackoverflow.com/questions/50420374/how-to-cold-boot-emulators-running-api-27-on-android-studio</a> <a href="#fnref:coldboot" class="reversefootnote" role="doc-backlink">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:avd-hw">
      <p><a href="https://stackoverflow.com/questions/15100251/avd-hardware-buttons-not-enabled">https://stackoverflow.com/questions/15100251/avd-hardware-buttons-not-enabled</a> <a href="#fnref:avd-hw" class="reversefootnote" role="doc-backlink">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:avd-net">
      <p><a href="https://developer.android.com/studio/run/emulator-networking">https://developer.android.com/studio/run/emulator-networking</a> <a href="#fnref:avd-net" class="reversefootnote" role="doc-backlink">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:video">
      <p><a href="https://www.youtube.com/watch?v=CJR_BSIStmE">https://www.youtube.com/watch?v=CJR_BSIStmE</a> <a href="#fnref:video" class="reversefootnote" role="doc-backlink">&#8617;&#xfe0e;</a></p>
    </li>
    <li id="fn:mitmproxy">
      <p><a href="https://docs.mitmproxy.org/stable/howto-install-system-trusted-ca-android/">https://docs.mitmproxy.org/stable/howto-install-system-trusted-ca-android/</a> <a href="#fnref:mitmproxy" class="reversefootnote" role="doc-backlink">&#8617;&#xfe0e;</a></p>
    </li>
  </ol>
</div>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/articles-writeups/">Articles & Writeups</a>,
          <a href="/categories/android/">Android</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/android/"
            class="post-tag no-text-decoration"
          >android</a>
        
          <a
            href="/tags/hacking-lab/"
            class="post-tag no-text-decoration"
          >hacking-lab</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://twitter.com/intent/tweet?text=How%20to%20set%20up%20an%20Android%20Penetration%20Testing%20Lab%20from%20scratch%20-%200xbro&url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fandroid-pentesting-lab%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter">
        <i class="fa-fw fa-brands fa-square-x-twitter"></i>
      </a>
    

      

      <a href="https://www.facebook.com/sharer/sharer.php?title=How%20to%20set%20up%20an%20Android%20Penetration%20Testing%20Lab%20from%20scratch%20-%200xbro&u=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fandroid-pentesting-lab%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook">
        <i class="fa-fw fab fa-facebook-square"></i>
      </a>
    

      

      <a href="https://t.me/share/url?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fandroid-pentesting-lab%2F&text=How%20to%20set%20up%20an%20Android%20Penetration%20Testing%20Lab%20from%20scratch%20-%200xbro" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram">
        <i class="fa-fw fab fa-telegram"></i>
      </a>
    

      

      <a href="https://www.linkedin.com/feed/?shareActive=true&shareUrl=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fandroid-pentesting-lab%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin">
        <i class="fa-fw fab fa-linkedin"></i>
      </a>
    

      

      <a href="https://www.reddit.com/submit?url=http%3A%2F%2Flocalhost%3A4000%2Fposts%2Fandroid-pentesting-lab%2F&title=How%20to%20set%20up%20an%20Android%20Penetration%20Testing%20Lab%20from%20scratch%20-%200xbro" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Reddit" aria-label="Reddit">
        <i class="fa-fw fa-brands fa-square-reddit"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/how-i-keep-updated/">How I keep updated in the infosec industry</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/vtenext-25-02-a-three-way-path-to-rce/">Vtenext 25.02 vulnerability research</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/wp-prevent-direct-access-CVE-2025-3861/">Incorrect Authorization to Authenticated (Contributor+) Multiple Media Actions in Prevent Direct Access Wordpress Plugin (CVE-2025-3861)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/effective-notes-with-obsidian/">Effective Notes for OSCP, CTFs and Pentests with Obsidian (2025)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/salesforce-hacking/">Pentesting Salesforce Communities</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/hackthebox/">hackthebox</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/deserialization/">deserialization</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/android/">android</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/php/">PHP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/interview/">interview</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/oscp/">OSCP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/podcast/">podcast</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ato/">ATO</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/hacking-lab/">hacking-lab</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/note-taking/">note-taking</a>
      
    </div>
  </section>


            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/intercept-https-on-non-rooted-devices/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1663624800"
  data-df="ll"
  
>
  Sep 20, 2022
</time>

              <h4 class="pt-0 my-2">Intercept HTTPS on non-rooted Android devices</h4>
              <div class="text-muted">
                <p>Learn how to intercept HTTPS on non-rooted Android devices in this Android HackTheBox challange called Anchored.</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/certificate-pinning-bypass/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1648677600"
  data-df="ll"
  
>
  Mar 31, 2022
</time>

              <h4 class="pt-0 my-2">Bypass certificate pinning with Frida and Xposed</h4>
              <div class="text-muted">
                <p>Learn how to bypass certificate pinning with Frida and Xposed in this Android HackTheBox challange called Pinned.</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/reverse-and-patch-an-easy-apk/" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1647298800"
  data-df="ll"
  
>
  Mar 15, 2022
</time>

              <h4 class="pt-0 my-2">Reverse and patch an easy APK</h4>
              <div class="text-muted">
                <p>Learn how to reverse and patch an easy APK in this Android HackTheBox challange called APKrypt.</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/waf-bypass-exploiting-parser-differentials/"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>WAF bypass and vulnerability chain exploiting parser differentials</p>
    </a>
  

  
    <a
      href="/posts/hacking-custom-reset-password-tokens/"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Defeating custom password reset tokens</p>
    </a>
  
</nav>

            

            <footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>©
    <time>2026</time>

    
      <a href="https://github.com/0xb120">0xbro</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>
   Powered by ☕, 🐛🐜🐞, vulnerabilities and exploits
  </p>
</footer>
          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/hackthebox/">hackthebox</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/deserialization/">deserialization</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/android/">android</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/php/">PHP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/interview/">interview</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/oscp/">OSCP</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/podcast/">podcast</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ato/">ATO</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/hacking-lab/">hacking-lab</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/note-taking/">note-taking</a>
      
    </div>
  </section>


    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{content}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

