---
title: "Exploit Zip Slip vulnerability in python tarfile"
date: 2022-04-25
categories: [Articles & Writeups, Web Hacking]
tags: [hackthebox, python]
description: Learn how to exploit Zip Slip vulnerability in python tarfile! HackTheBox &quot;slippy&quot; wirteup is now available!
toc: true
media_subpath: /assets/img/slippy/
image: thumbnail.png
---

## Introduction
**Slippy** is an easy difficulty web challenge from HackTheBox vulnerable to **Zip Slip** because of the insecure use of the TarFile's python module "extractall".
Due to the absence of file name checks it is possible to create a malicious archive containing path traversals in order to overwrite other files and obtain remote code execution.

### Improved skills
- Code review
- Exploit Zip Slip vulnerability to get RCE

### Used tools
- burpsuite
- tar

## Video
<iframe width="736" height="491" src="https://www.youtube.com/embed/8eXutSxYhOQ" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

## Notes
### Generate malicious tar.gz files containing relative path
```bash
tar -czvf files.tar.gz --absolute-names '../../../../../tmp/test.txt'
```
You can also use [evilarc.py](https://github.com/ptoomey3/evilarc/blob/master/evilarc.py)

### tarfile and zip slip vulneraiblity related articles and notes
- [tarfile and directory traversal vulnerability](https://mail.python.org/pipermail/python-dev/2007-August/074290.html)
- [tarfile: Traversal attack vulnerability](https://bugs.python.org/issue21109)
- [Zip Slip Vulnerability - Snyk](https://snyk.io/research/zip-slip-vulnerability)
- [Exploiting insecure file extraction in Python for code execution](https://ajinabraham.com/blog/exploiting-insecure-file-extraction-in-python-for-code-execution)
